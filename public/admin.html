<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Admin Panel Pro - DROGUA CENTER</title>
  <style>
:root {
  --bg: #0a0e14;
  --bg-secondary: #0d1419;
  --card: #151b23;
  --card-hover: #1a212b;
  --text: #e8edf2;
  --text-secondary: #b4c0ce;
  --muted: #7a8594;
  --accent: #5ba3f5;
  --accent-hover: #6baff7;
  --accent-light: rgba(91, 163, 245, 0.1);
  --border: #2a3441;
  --success: #10b981;
  --danger: #ef4444;
  --warning: #f59e0b;
  --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  --shadow-sm: 0 2px 4px rgba(0,0,0,0.2);
  --shadow-md: 0 4px 12px rgba(0,0,0,0.3);
  --shadow-lg: 0 10px 30px rgba(0,0,0,0.4);
  --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

[data-theme="light"] {
  --bg: #f8fafc;
  --bg-secondary: #ffffff;
  --card: #ffffff;
  --card-hover: #f1f5f9;
  --text: #1e293b;
  --text-secondary: #475569;
  --muted: #94a3b8;
  --border: #e2e8f0;
  --accent-light: rgba(91, 163, 245, 0.1);
  --shadow-sm: 0 1px 3px rgba(0,0,0,0.1);
  --shadow-md: 0 4px 6px rgba(0,0,0,0.1);
  --shadow-lg: 0 10px 15px rgba(0,0,0,0.1);
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  transition: var(--transition);
}

/* Animations */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes slideDown {
  from { opacity: 0; transform: translateY(-20px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.05); }
}

@keyframes shimmer {
  0% { background-position: -1000px 0; }
  100% { background-position: 1000px 0; }
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* Layout */
.container {
  max-width: 1600px;
  margin: 0 auto;
  padding: 20px;
  animation: fadeIn 0.5s ease;
}

/* Header */
.header {
  background: var(--card);
  border-radius: 20px;
  padding: 24px 32px;
  margin-bottom: 30px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  box-shadow: var(--shadow-md);
  animation: slideDown 0.5s ease;
  border: 1px solid var(--border);
}

.header h1 {
  font-size: 28px;
  font-weight: 800;
  background: var(--gradient);
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  display: flex;
  align-items: center;
  gap: 12px;
}

.header-actions {
  display: flex;
  gap: 12px;
  align-items: center;
}

/* Theme Toggle */
.theme-toggle {
  width: 50px;
  height: 26px;
  background: var(--border);
  border-radius: 26px;
  position: relative;
  cursor: pointer;
  transition: var(--transition);
}

.theme-toggle::after {
  content: 'üåô';
  position: absolute;
  top: 3px;
  left: 3px;
  width: 20px;
  height: 20px;
  background: var(--bg);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  transition: var(--transition);
}

.theme-toggle.light {
  background: var(--accent);
}

.theme-toggle.light::after {
  content: '‚òÄÔ∏è';
  left: calc(100% - 23px);
  background: white;
}

/* Login */
#auth {
  max-width: 450px;
  margin: 100px auto;
  background: var(--card);
  padding: 40px;
  border-radius: 24px;
  border: 1px solid var(--border);
  box-shadow: var(--shadow-lg);
  animation: fadeIn 0.5s ease;
}

#auth h2 {
  font-size: 32px;
  margin-bottom: 30px;
  text-align: center;
  background: var(--gradient);
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
}

/* Forms */
input, button, select, textarea {
  padding: 14px 18px;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: var(--bg-secondary);
  color: var(--text);
  width: 100%;
  font-size: 14px;
  margin-bottom: 12px;
  font-family: inherit;
  transition: var(--transition);
}

input:hover, select:hover, textarea:hover {
  border-color: var(--muted);
}

input:focus, select:focus, textarea:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px var(--accent-light);
}

button {
  background: var(--gradient);
  color: white;
  border: none;
  cursor: pointer;
  font-weight: 600;
  position: relative;
  overflow: hidden;
}

button::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
  transition: left 0.5s;
}

button:hover::before {
  left: 100%;
}

button:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-md);
}

button:active {
  transform: translateY(0);
}

button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

/* Dashboard */
#dash {
  display: none;
  animation: fadeIn 0.5s ease;
}

/* Stats Cards */
.stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 24px;
  margin-bottom: 30px;
}

.stat-card {
  background: var(--card);
  padding: 24px;
  border-radius: 20px;
  border: 1px solid var(--border);
  transition: var(--transition);
  position: relative;
  overflow: hidden;
  cursor: pointer;
}

.stat-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 4px;
  background: var(--gradient);
  transform: scaleX(0);
  transition: transform 0.3s ease;
  transform-origin: left;
}

.stat-card:hover::before {
  transform: scaleX(1);
}

.stat-card:hover {
  transform: translateY(-4px);
  box-shadow: var(--shadow-lg);
  background: var(--card-hover);
}

.stat-card h3 {
  font-size: 13px;
  color: var(--muted);
  margin-bottom: 12px;
  text-transform: uppercase;
  letter-spacing: 1px;
  font-weight: 600;
}

.stat-card .value {
  font-size: 36px;
  font-weight: 800;
  background: var(--gradient);
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  margin-bottom: 8px;
}

.stat-card .trend {
  font-size: 13px;
  display: flex;
  align-items: center;
  gap: 6px;
}

.trend.up { color: var(--success); }
.trend.down { color: var(--danger); }

.trend span:first-child {
  font-size: 18px;
  animation: pulse 2s infinite;
}

/* Tabs */
.tabs {
  display: flex;
  gap: 8px;
  margin-bottom: 24px;
  padding: 8px;
  background: var(--card);
  border-radius: 16px;
  border: 1px solid var(--border);
  overflow-x: auto;
  scrollbar-width: thin;
  scrollbar-color: var(--border) transparent;
}

.tabs::-webkit-scrollbar {
  height: 6px;
}

.tabs::-webkit-scrollbar-track {
  background: transparent;
}

.tabs::-webkit-scrollbar-thumb {
  background: var(--border);
  border-radius: 3px;
}

.tab-btn {
  background: transparent;
  border: none;
  color: var(--muted);
  padding: 12px 24px;
  cursor: pointer;
  border-radius: 12px;
  transition: var(--transition);
  white-space: nowrap;
  font-weight: 600;
  position: relative;
  margin: 0;
}

.tab-btn::before {
  content: '';
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%) scaleX(0);
  width: 30px;
  height: 3px;
  background: var(--accent);
  border-radius: 3px;
  transition: transform 0.3s ease;
}

.tab-btn:hover {
  background: var(--accent-light);
  color: var(--text);
}

.tab-btn.active {
  background: var(--gradient);
  color: white;
}

.tab-btn.active::before {
  transform: translateX(-50%) scaleX(1);
}

/* Tab Content */
.tab-content {
  display: none;
  animation: fadeIn 0.5s ease;
}

.tab-content.active {
  display: block;
}

/* Toolbar */
.toolbar {
  display: flex;
  gap: 12px;
  margin-bottom: 24px;
  flex-wrap: wrap;
  align-items: center;
  padding: 16px;
  background: var(--card);
  border-radius: 16px;
  border: 1px solid var(--border);
}

.toolbar input, .toolbar select {
  flex: 1;
  min-width: 200px;
  margin: 0;
}

.toolbar button {
  width: auto;
  margin: 0;
  padding: 14px 24px;
}

/* Search Input */
input[type="text"][placeholder*="üîç"] {
  padding-left: 44px;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%237a8594' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='11' cy='11' r='8'%3E%3C/circle%3E%3Cpath d='m21 21-4.35-4.35'%3E%3C/path%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: 14px center;
  background-size: 20px;
}

/* Table */
.table-container {
  background: var(--card);
  border-radius: 20px;
  overflow: hidden;
  border: 1px solid var(--border);
  box-shadow: var(--shadow-md);
  transition: var(--transition);
}

.table-container:hover {
  box-shadow: var(--shadow-lg);
}

table {
  width: 100%;
  border-collapse: collapse;
}

th, td {
  padding: 16px;
  text-align: left;
  border-bottom: 1px solid var(--border);
}

th {
  background: var(--bg-secondary);
  font-weight: 700;
  color: var(--muted);
  font-size: 12px;
  text-transform: uppercase;
  letter-spacing: 1px;
  position: sticky;
  top: 0;
  z-index: 10;
}

tbody tr {
  transition: var(--transition);
}

tbody tr:hover {
  background: var(--card-hover);
}

tbody tr:last-child td {
  border-bottom: none;
}

/* Badges */
.badge {
  background: var(--accent-light);
  color: var(--accent);
  padding: 6px 12px;
  border-radius: 20px;
  font-size: 11px;
  font-weight: 700;
  display: inline-flex;
  align-items: center;
  gap: 4px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.badge.success {
  background: rgba(16, 185, 129, 0.15);
  color: var(--success);
}

.badge.warning {
  background: rgba(245, 158, 11, 0.15);
  color: var(--warning);
}

.badge.danger {
  background: rgba(239, 68, 68, 0.15);
  color: var(--danger);
}

/* Actions Buttons */
.actions {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.btn-sm {
  padding: 8px 16px;
  font-size: 12px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  transition: var(--transition);
  margin: 0;
  white-space: nowrap;
  font-weight: 600;
}

.btn-primary {
  background: var(--accent);
  color: white;
}

.btn-success {
  background: var(--success);
  color: white;
}

.btn-danger {
  background: var(--danger);
  color: white;
}

.btn-warning {
  background: var(--warning);
  color: white;
}

.btn-sm:hover {
  transform: scale(1.05);
  box-shadow: var(--shadow-md);
}

/* Empty State */
.empty-state {
  text-align: center;
  padding: 80px 20px;
  color: var(--muted);
  font-size: 16px;
}

.empty-state::before {
  content: 'üì≠';
  display: block;
  font-size: 48px;
  margin-bottom: 16px;
  opacity: 0.5;
}

/* Modal */
.modal {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.8);
  backdrop-filter: blur(10px);
  z-index: 1000;
  display: none;
  align-items: center;
  justify-content: center;
  padding: 20px;
}

.modal.active {
  display: flex;
  animation: fadeIn 0.3s ease;
}

.modal-content {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 24px;
  padding: 32px;
  max-width: 600px;
  width: 100%;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: var(--shadow-lg);
  animation: slideDown 0.3s ease;
}

.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
}

.modal-header h3 {
  font-size: 24px;
  font-weight: 700;
}

.modal-close {
  background: transparent;
  border: none;
  color: var(--text);
  font-size: 28px;
  cursor: pointer;
  padding: 0;
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 8px;
  transition: var(--transition);
}

.modal-close:hover {
  background: var(--accent-light);
  color: var(--accent);
}

.modal-body {
  margin-bottom: 24px;
}

.modal-footer {
  display: flex;
  gap: 12px;
  justify-content: flex-end;
}

/* Form Groups */
.form-group {
  margin-bottom: 20px;
}

.form-group label {
  display: block;
  margin-bottom: 8px;
  color: var(--text-secondary);
  font-size: 13px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.form-group input,
.form-group select,
.form-group textarea {
  margin: 0;
}

/* Charts */
.chart-container {
  background: var(--card);
  padding: 24px;
  border-radius: 20px;
  border: 1px solid var(--border);
  margin-bottom: 24px;
  transition: var(--transition);
}

.chart-container:hover {
  box-shadow: var(--shadow-md);
  transform: translateY(-2px);
}

.chart-container h3 {
  margin-bottom: 20px;
  font-size: 18px;
  font-weight: 700;
  display: flex;
  align-items: center;
  gap: 8px;
}

/* Loading */
.loading {
  display: none;
  justify-content: center;
  align-items: center;
  padding: 60px;
}

.loading.active {
  display: flex;
}

.spinner {
  border: 3px solid var(--border);
  border-top-color: var(--accent);
  border-radius: 50%;
  width: 48px;
  height: 48px;
  animation: spin 1s linear infinite;
}

/* Toast */
.toast-container {
  position: fixed;
  top: 24px;
  right: 24px;
  z-index: 2000;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.toast {
  background: var(--card);
  border: 1px solid var(--border);
  border-left: 4px solid var(--success);
  padding: 16px 24px;
  border-radius: 12px;
  box-shadow: var(--shadow-lg);
  min-width: 300px;
  opacity: 0;
  transform: translateX(400px);
  transition: var(--transition);
  display: flex;
  align-items: center;
  gap: 12px;
}

.toast::before {
  content: '‚úÖ';
  font-size: 20px;
}

.toast.show {
  opacity: 1;
  transform: translateX(0);
}

.toast.error {
  border-left-color: var(--danger);
}

.toast.error::before {
  content: '‚ùå';
}

.toast.warning {
  border-left-color: var(--warning);
}

.toast.warning::before {
  content: '‚ö†Ô∏è';
}

/* Stock Form */
.stock-form {
  background: var(--card);
  padding: 24px;
  border-radius: 20px;
  border: 1px solid var(--border);
  margin-bottom: 24px;
  transition: var(--transition);
}

.stock-form:hover {
  box-shadow: var(--shadow-md);
}

.stock-form h3 {
  margin-bottom: 20px;
  font-size: 18px;
  font-weight: 700;
}

.stock-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 16px;
  margin-bottom: 16px;
}

.stock-grid > div label {
  display: block;
  margin-bottom: 8px;
  color: var(--muted);
  font-size: 12px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

/* Quick Stats */
.quick-stats {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  gap: 12px;
  padding: 16px;
  background: var(--bg-secondary);
  border-radius: 12px;
  margin-bottom: 24px;
}

.quick-stat {
  text-align: center;
  padding: 12px;
  background: var(--card);
  border-radius: 8px;
  border: 1px solid var(--border);
  transition: var(--transition);
  cursor: pointer;
}

.quick-stat:hover {
  transform: scale(1.05);
  box-shadow: var(--shadow-md);
}

.quick-stat .label {
  font-size: 11px;
  color: var(--muted);
  text-transform: uppercase;
  margin-bottom: 4px;
}

.quick-stat .value {
  font-size: 20px;
  font-weight: 700;
  color: var(--accent);
}

/* Responsive */
@media (max-width: 1200px) {
  .stats {
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  }
}

@media (max-width: 768px) {
  .header {
    flex-direction: column;
    gap: 16px;
    text-align: center;
  }
  
  .stats {
    grid-template-columns: 1fr;
  }
  
  .toolbar {
    flex-direction: column;
  }
  
  .toolbar input,
  .toolbar select {
    width: 100%;
  }
  
  .stock-grid {
    grid-template-columns: 1fr;
  }
  
  .actions {
    flex-wrap: wrap;
  }
  
  .tabs {
    overflow-x: auto;
    gap: 4px;
  }
  
  .tab-btn {
    padding: 10px 16px;
    font-size: 13px;
  }
  
  th, td {
    padding: 12px 8px;
    font-size: 13px;
  }
  
  .modal-content {
    padding: 24px;
  }
}

/* Settings Menu */
.settings-menu {
  padding: 8px;
}

.settings-menu-item {
  padding: 14px 20px;
  cursor: pointer;
  border-radius: 12px;
  margin-bottom: 4px;
  transition: var(--transition);
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 10px;
}

.settings-menu-item:hover {
  background: var(--accent-light);
  color: var(--accent);
}

.settings-menu-item.active {
  background: var(--gradient);
  color: white;
}

.settings-section {
  display: none;
}

.settings-section.active {
  display: block;
}

/* Product Grid */
.product-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
  gap: 20px;
  margin-top: 20px;
}

.product-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 20px;
  transition: var(--transition);
  cursor: pointer;
}

.product-card:hover {
  transform: translateY(-4px);
  box-shadow: var(--shadow-lg);
}

.product-image {
  width: 100%;
  height: 150px;
  background: var(--gradient);
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 48px;
  margin-bottom: 16px;
}

.product-name {
  font-size: 18px;
  font-weight: 700;
  margin-bottom: 8px;
}

.product-price {
  color: var(--accent);
  font-size: 20px;
  font-weight: 600;
}
@media print {
  body {
    background: white;
    color: black;
  }
  
  .header-actions,
  .toolbar button,
  .actions,
  .tabs {
    display: none !important;
  }
  
  .table-container {
    box-shadow: none;
    border: 1px solid #ddd;
  }
  
  .badge {
    border: 1px solid currentColor;
    padding: 2px 6px;
  }
}

/* Skeleton Loading */
.skeleton {
  background: linear-gradient(90deg, var(--border) 25%, var(--card-hover) 50%, var(--border) 75%);
  background-size: 200% 100%;
  animation: shimmer 1.5s infinite;
  border-radius: 4px;
}

/* Notification Bell */
.notification-bell {
  position: relative;
  cursor: pointer;
}

.notification-count {
  position: absolute;
  top: -8px;
  right: -8px;
  background: var(--danger);
  color: white;
  font-size: 10px;
  font-weight: 700;
  padding: 2px 6px;
  border-radius: 12px;
  min-width: 18px;
  text-align: center;
}

/* Progress Bar */
.progress-bar {
  width: 100%;
  height: 8px;
  background: var(--border);
  border-radius: 8px;
  overflow: hidden;
  margin: 8px 0;
}

.progress-fill {
  height: 100%;
  background: var(--gradient);
  border-radius: 8px;
  transition: width 0.5s ease;
}

/* Dropdown */
.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  position: absolute;
  top: 100%;
  right: 0;
  margin-top: 8px;
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  box-shadow: var(--shadow-lg);
  min-width: 200px;
  opacity: 0;
  pointer-events: none;
  transform: translateY(-10px);
  transition: var(--transition);
  z-index: 100;
}

.dropdown.active .dropdown-content {
  opacity: 1;
  pointer-events: all;
  transform: translateY(0);
}

.dropdown-item {
  padding: 12px 16px;
  cursor: pointer;
  transition: var(--transition);
  border-radius: 8px;
  margin: 4px;
}

.dropdown-item:hover {
  background: var(--accent-light);
  color: var(--accent);
}
  </style>
</head>
<body data-theme="dark">

<div class="container">
  <!-- Login -->
  <div id="auth">
    <h2>üöÄ Admin Panel Pro</h2>
    <div>
      <input id="pass" type="password" placeholder="Mot de passe administrateur" autocomplete="current-password">
      <button id="loginBtn" onclick="handleLogin()">Se connecter</button>
    </div>
    <div style="text-align:center;margin-top:20px;color:var(--muted);font-size:12px">
      <p>üîí Connexion s√©curis√©e</p>
      <p style="margin-top:10px;color:var(--accent)">Mot de passe : gangstaforlife12</p>
    </div>
  </div>

  <!-- Dashboard -->
  <div id="dash">
    <!-- Header -->
    <div class="header">
      <h1>
        <span>üéØ</span>
        <span>DROGUA CENTER</span>
      </h1>
      <div class="header-actions">
        <div class="notification-bell">
          <span style="font-size:24px;cursor:pointer">üîî</span>
          <span class="notification-count" id="notifCount" style="display:none">0</span>
        </div>
        <div class="theme-toggle" id="themeToggle"></div>
        <div class="dropdown">
          <button id="userMenu" style="padding:10px 20px;margin:0">üë§ Admin</button>
          <div class="dropdown-content">
            <div class="dropdown-item" onclick="showProfile()">üìä Mon Profil</div>
            <div class="dropdown-item" onclick="showSettings()">‚öôÔ∏è Param√®tres</div>
            <div class="dropdown-item" onclick="exportAllData()">üíæ Export donn√©es</div>
            <div class="dropdown-item" onclick="logout()" style="color:var(--danger)">üö™ D√©connexion</div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Quick Stats -->
    <div class="quick-stats" id="quickStats">
      <div class="quick-stat">
        <div class="label">Aujourd'hui</div>
        <div class="value" id="todayRevenue">0‚Ç¨</div>
      </div>
      <div class="quick-stat">
        <div class="label">Cette semaine</div>
        <div class="value" id="weekRevenue">0‚Ç¨</div>
      </div>
      <div class="quick-stat">
        <div class="label">Ce mois</div>
        <div class="value" id="monthRevenue">0‚Ç¨</div>
      </div>
      <div class="quick-stat">
        <div class="label">Commandes actives</div>
        <div class="value" id="activeOrders">0</div>
      </div>
      <div class="quick-stat">
        <div class="label">Stock faible</div>
        <div class="value" id="lowStock" style="color:var(--warning)">0</div>
      </div>
      <div class="quick-stat">
        <div class="label">Avis en attente</div>
        <div class="value" id="pendingReviews">0</div>
      </div>
    </div>

    <!-- Main Stats -->
    <div class="stats" id="mainStats">
      <div class="stat-card">
        <h3>üí∞ Chiffre d'affaires total</h3>
        <div class="value" id="totalCA">0,00 ‚Ç¨</div>
        <div class="trend up" id="trendCA">
          <span>‚Üó</span>
          <span>+0% vs mois dernier</span>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" id="progressCA" style="width:0%"></div>
        </div>
      </div>
      <div class="stat-card">
        <h3>üì¶ Nombre de commandes</h3>
        <div class="value" id="totalOrders">0</div>
        <div class="trend up" id="trendOrders">
          <span>‚Üó</span>
          <span>+0 cette semaine</span>
        </div>
      </div>
      <div class="stat-card">
        <h3>üõí Panier moyen</h3>
        <div class="value" id="avgOrder">0,00 ‚Ç¨</div>
        <div class="trend" id="trendAvg">
          <span>‚Üí</span>
          <span>Stable</span>
        </div>
      </div>
      <div class="stat-card">
        <h3>üèÜ Produit le plus vendu</h3>
        <div class="value" style="font-size:24px" id="topProduct">-</div>
        <div style="color:var(--muted);font-size:12px;margin-top:8px" id="topProductSales">0 ventes</div>
      </div>
      <div class="stat-card">
        <h3>üíé Valeur totale du stock</h3>
        <div class="value" id="stockValue">0,00 ‚Ç¨</div>
        <div style="color:var(--muted);font-size:12px;margin-top:8px" id="stockItems">0 articles</div>
      </div>
      <div class="stat-card">
        <h3>‚ö†Ô∏è Alertes stock</h3>
        <div class="value" style="color:var(--warning)" id="stockAlerts">0</div>
        <div id="stockAlertDetails" style="font-size:12px;margin-top:8px"></div>
      </div>
    </div>

    <!-- Tabs -->
    <div class="tabs">
      <button class="tab-btn active" data-tab="dashboard">üìä Tableau de bord</button>
      <button class="tab-btn" data-tab="orders">üì¶ Commandes</button>
      <button class="tab-btn" data-tab="finances">üí∞ Finances</button>
      <button class="tab-btn" data-tab="stock">üìà Stock</button>
      <button class="tab-btn" data-tab="products">üõç Produits</button>
      <button class="tab-btn" data-tab="customers">üë• Clients</button>
      <button class="tab-btn" data-tab="analytics">üìä Analytics</button>
      <button class="tab-btn" data-tab="settings">‚öôÔ∏è Param√®tres</button>
    </div>

    <!-- Tab: Dashboard -->
    <div class="tab-content active" id="tab-dashboard">
      <!-- Live Activity Feed -->
      <div class="chart-container">
        <h3>üî¥ Activit√© en temps r√©el</h3>
        <div id="activityFeed" style="max-height:300px;overflow-y:auto">
          <div style="padding:40px;text-align:center;color:var(--muted)">
            Aucune activit√© r√©cente
          </div>
        </div>
      </div>

      <!-- Sales Chart -->
      <div class="chart-container">
        <h3>üìà √âvolution des ventes (30 derniers jours)</h3>
        <div id="salesChart" style="display:flex;gap:8px;align-items:flex-end;height:250px;padding:20px;background:var(--bg-secondary);border-radius:12px">
          <div style="flex:1;background:var(--gradient);height:40%;border-radius:4px 4px 0 0"></div>
          <div style="flex:1;background:var(--gradient);height:60%;border-radius:4px 4px 0 0"></div>
          <div style="flex:1;background:var(--gradient);height:75%;border-radius:4px 4px 0 0"></div>
          <div style="flex:1;background:var(--gradient);height:50%;border-radius:4px 4px 0 0"></div>
          <div style="flex:1;background:var(--gradient);height:85%;border-radius:4px 4px 0 0"></div>
          <div style="flex:1;background:var(--gradient);height:70%;border-radius:4px 4px 0 0"></div>
          <div style="flex:1;background:var(--gradient);height:90%;border-radius:4px 4px 0 0"></div>
          <div style="flex:1;background:var(--gradient);height:65%;border-radius:4px 4px 0 0"></div>
          <div style="flex:1;background:var(--gradient);height:80%;border-radius:4px 4px 0 0"></div>
          <div style="flex:1;background:var(--gradient);height:100%;border-radius:4px 4px 0 0"></div>
        </div>
        <div style="display:flex;justify-content:space-between;margin-top:12px;padding:0 20px;font-size:11px;color:var(--muted)">
          <span>J1</span>
          <span>J5</span>
          <span>J10</span>
          <span>J15</span>
          <span>J20</span>
          <span>J25</span>
          <span>J30</span>
        </div>
      </div>

      <!-- Performance Metrics -->
      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:24px;margin-top:24px">
        <div class="chart-container">
          <h3>üéØ Objectifs du mois</h3>
          <div style="margin:20px 0">
            <div style="display:flex;justify-content:space-between;margin-bottom:8px">
              <span>Chiffre d'affaires</span>
              <span id="goalCA">0%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" id="goalCABar" style="width:0%"></div>
            </div>
            <div style="display:flex;justify-content:space-between;margin-top:16px;margin-bottom:8px">
              <span>Nouvelles commandes</span>
              <span id="goalOrders">0%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" id="goalOrdersBar" style="width:0%"></div>
            </div>
            <div style="display:flex;justify-content:space-between;margin-top:16px;margin-bottom:8px">
              <span>Nouveaux clients</span>
              <span id="goalCustomers">0%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" id="goalCustomersBar" style="width:0%"></div>
            </div>
          </div>
        </div>
        
        <div class="chart-container">
          <h3>üèÜ Top 5 Produits</h3>
          <div id="topProductsChart">
            <div style="padding:40px;text-align:center;color:var(--muted)">
              Chargement...
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Tab: Orders -->
    <div class="tab-content" id="tab-orders">
      <div class="toolbar">
        <input type="text" id="searchOrders" placeholder="üîç Rechercher une commande...">
        <select id="filterStatus">
          <option value="all">Tous les statuts</option>
          <option value="pending">‚è≥ En attente</option>
          <option value="processing">üîÑ En traitement</option>
          <option value="delivered">‚úÖ Livr√©</option>
          <option value="cancelled">‚ùå Annul√©</option>
        </select>
        <select id="filterPeriod">
          <option value="all">Toute p√©riode</option>
          <option value="today">Aujourd'hui</option>
          <option value="week">Cette semaine</option>
          <option value="month">Ce mois</option>
        </select>
        <button id="exportOrders">üì• Exporter</button>
        <button id="refreshOrders">üîÑ Actualiser</button>
        <button id="newOrder" style="background:var(--success)">‚ûï Nouvelle commande</button>
      </div>

      <div class="loading" id="ordersLoading">
        <div class="spinner"></div>
      </div>

      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>Date</th>
              <th>Client</th>
              <th>Articles</th>
              <th>Total</th>
              <th>Statut</th>
              <th>Paiement</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="ordersTable">
            <tr>
              <td colspan="8" class="empty-state">Aucune commande</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Tab: Finances -->
    <div class="tab-content" id="tab-finances">
      <!-- Finance Stats -->
      <div class="stats">
        <div class="stat-card">
          <h3>üíµ Revenus du mois</h3>
          <div class="value" id="monthlyRevenue">0,00 ‚Ç¨</div>
          <div class="trend up">
            <span>‚Üó</span>
            <span>+12% vs mois dernier</span>
          </div>
        </div>
        <div class="stat-card">
          <h3>üí∏ D√©penses du mois</h3>
          <div class="value" style="color:var(--danger)" id="monthlyExpenses">0,00 ‚Ç¨</div>
          <div class="trend down">
            <span>‚Üò</span>
            <span>-5% vs mois dernier</span>
          </div>
        </div>
        <div class="stat-card">
          <h3>üí∞ B√©n√©fice net</h3>
          <div class="value" id="netProfit">0,00 ‚Ç¨</div>
          <div class="trend up">
            <span>‚Üó</span>
            <span>+18% vs mois dernier</span>
          </div>
        </div>
        <div class="stat-card">
          <h3>üìä Marge moyenne</h3>
          <div class="value" id="profitMargin">0%</div>
          <div style="color:var(--muted);font-size:12px;margin-top:8px">Sur tous les produits</div>
        </div>
        <div class="stat-card">
          <h3>üéØ ROI Global</h3>
          <div class="value" style="color:var(--success)" id="globalROI">0%</div>
          <div style="color:var(--muted);font-size:12px;margin-top:8px">Retour sur investissement</div>
        </div>
        <div class="stat-card">
          <h3>üíé Produit le + rentable</h3>
          <div class="value" style="font-size:24px" id="mostProfitable">-</div>
          <div style="color:var(--success);font-size:12px;margin-top:8px" id="mostProfitableMargin">0% de marge</div>
        </div>
      </div>

      <!-- Calculateur de rentabilit√© -->
      <div class="chart-container" style="margin-top:24px">
        <h3>üßÆ Calculateur de rentabilit√© produit</h3>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;padding:20px;background:var(--bg-secondary);border-radius:12px">
          <div>
            <label style="display:block;margin-bottom:8px;color:var(--muted);font-size:12px">Produit</label>
            <select id="calcProduct" onchange="updateProfitCalculation()">
              <option value="">S√©lectionner un produit</option>
              <option value="amnesia">AMNESIA</option>
              <option value="needles">NEEDLES KETA</option>
              <option value="champagne">CHAMPAGNE</option>
              <option value="eljefe">EL JEFE</option>
              <option value="skittlez">SKITTLEZ CAKE</option>
              <option value="pistacchio">PISTACCHIO</option>
              <option value="dembele">DEMBELE</option>
              <option value="lemon">LEMON X GELATO</option>
              <option value="georgia">GEORGIA PIE</option>
              <option value="domino">DOMINO</option>
              <option value="fresh">FRESH FROZEN</option>
            </select>
          </div>
          <div>
            <label style="display:block;margin-bottom:8px;color:var(--muted);font-size:12px">Quantit√© (g ou unit√©s)</label>
            <select id="calcQuantity" onchange="updateProfitCalculation()">
              <option value="">S√©lectionner</option>
              <option value="1">1G</option>
              <option value="2">2G</option>
              <option value="3">3G</option>
              <option value="3.5">3.5G</option>
              <option value="5">5G</option>
              <option value="10">10G</option>
              <option value="50">50G</option>
              <option value="100">100G</option>
            </select>
          </div>
          <div>
            <label style="display:block;margin-bottom:8px;color:var(--muted);font-size:12px">Prix d'achat (‚Ç¨/g)</label>
            <input type="number" id="calcBuyPrice" placeholder="0.00" step="0.01" oninput="updateProfitCalculation()">
          </div>
          <div>
            <label style="display:block;margin-bottom:8px;color:var(--muted);font-size:12px">Prix de vente (‚Ç¨)</label>
            <input type="number" id="calcSellPrice" placeholder="0.00" step="0.01" oninput="updateProfitCalculation()">
          </div>
          <div>
            <label style="display:block;margin-bottom:8px;color:var(--muted);font-size:12px">Nb de ventes pr√©vues</label>
            <input type="number" id="calcSalesCount" placeholder="0" value="1" min="1" oninput="updateProfitCalculation()">
          </div>
        </div>
        
        <!-- R√©sultats du calcul -->
        <div id="profitResults" style="display:none;margin-top:20px;padding:20px;background:var(--bg-secondary);border-radius:12px">
          <h4 style="margin-bottom:16px;color:var(--accent)">üìä Analyse de rentabilit√©</h4>
          <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px">
            <div style="text-align:center;padding:16px;background:var(--card);border-radius:8px">
              <div style="font-size:12px;color:var(--muted);margin-bottom:8px">Co√ªt total d'achat</div>
              <div style="font-size:24px;font-weight:700;color:var(--danger)" id="resultBuyCost">0‚Ç¨</div>
            </div>
            <div style="text-align:center;padding:16px;background:var(--card);border-radius:8px">
              <div style="font-size:12px;color:var(--muted);margin-bottom:8px">Prix de vente unitaire</div>
              <div style="font-size:24px;font-weight:700;color:var(--accent)" id="resultSellPrice">0‚Ç¨</div>
            </div>
            <div style="text-align:center;padding:16px;background:var(--card);border-radius:8px">
              <div style="font-size:12px;color:var(--muted);margin-bottom:8px">B√©n√©fice par unit√©</div>
              <div style="font-size:24px;font-weight:700;color:var(--success)" id="resultUnitProfit">0‚Ç¨</div>
            </div>
            <div style="text-align:center;padding:16px;background:var(--card);border-radius:8px">
              <div style="font-size:12px;color:var(--muted);margin-bottom:8px">Marge b√©n√©ficiaire</div>
              <div style="font-size:24px;font-weight:700;color:var(--warning)" id="resultMargin">0%</div>
            </div>
            <div style="text-align:center;padding:16px;background:var(--card);border-radius:8px">
              <div style="font-size:12px;color:var(--muted);margin-bottom:8px">Chiffre d'affaires total</div>
              <div style="font-size:24px;font-weight:700;color:var(--accent)" id="resultTotalRevenue">0‚Ç¨</div>
            </div>
            <div style="text-align:center;padding:16px;background:var(--card);border-radius:8px;border:2px solid var(--success)">
              <div style="font-size:12px;color:var(--muted);margin-bottom:8px">üí∞ B√©n√©fice net total</div>
              <div style="font-size:28px;font-weight:800;color:var(--success)" id="resultTotalProfit">0‚Ç¨</div>
            </div>
          </div>
          
          <!-- Graphique de rentabilit√© -->
          <div style="margin-top:20px">
            <div style="display:flex;justify-content:space-between;margin-bottom:8px">
              <span>R√©partition co√ªt/b√©n√©fice</span>
              <span id="profitRatio">0% de marge</span>
            </div>
            <div style="display:flex;height:40px;border-radius:8px;overflow:hidden">
              <div id="costBar" style="background:var(--danger);width:50%"></div>
              <div id="profitBar" style="background:var(--success);width:50%"></div>
            </div>
            <div style="display:flex;justify-content:space-between;margin-top:8px;font-size:12px;color:var(--muted)">
              <span>üí∏ Co√ªt</span>
              <span>üí∞ B√©n√©fice</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Tableau de rentabilit√© par produit -->
      <div class="chart-container" style="margin-top:24px">
        <h3>üìä Analyse de rentabilit√© par produit</h3>
        <div class="table-container" style="box-shadow:none;border:none">
          <table>
            <thead>
              <tr>
                <th>Produit</th>
                <th>Variant</th>
                <th>Co√ªt d'achat</th>
                <th>Prix de vente</th>
                <th>B√©n√©fice</th>
                <th>Marge %</th>
                <th>Ventes/mois</th>
                <th>Profit mensuel</th>
                <th>ROI</th>
              </tr>
            </thead>
            <tbody id="profitabilityTable">
              <tr>
                <td colspan="9" class="empty-state">Chargement des donn√©es de rentabilit√©...</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Simulateur de strat√©gie de prix -->
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-top:24px">
        <div class="chart-container">
          <h3>üí° Simulateur de strat√©gie de prix</h3>
          <div style="padding:20px">
            <div class="form-group">
              <label>Augmenter tous les prix de (%)</label>
              <input type="range" id="priceIncrease" min="-20" max="50" value="0" oninput="simulatePriceStrategy(this.value)">
              <div style="text-align:center;font-size:24px;color:var(--accent);margin-top:10px">
                <span id="priceIncreaseValue">0</span>%
              </div>
            </div>
            <div style="margin-top:20px;padding:16px;background:var(--bg-secondary);border-radius:8px">
              <div style="display:flex;justify-content:space-between;margin-bottom:12px">
                <span>Impact sur le CA mensuel:</span>
                <span id="revenueImpact" style="color:var(--accent)">+0‚Ç¨</span>
              </div>
              <div style="display:flex;justify-content:space-between;margin-bottom:12px">
                <span>Impact sur le b√©n√©fice:</span>
                <span id="profitImpact" style="color:var(--success)">+0‚Ç¨</span>
              </div>
              <div style="display:flex;justify-content:space-between">
                <span>Nouvelle marge moyenne:</span>
                <span id="newMargin" style="color:var(--warning)">0%</span>
              </div>
            </div>
          </div>
        </div>

        <div class="chart-container">
          <h3>üèÜ Top produits par rentabilit√©</h3>
          <div id="topProfitableProducts" style="padding:20px">
            <!-- Sera rempli dynamiquement -->
          </div>
        </div>
      </div>

      <!-- Pr√©visions de b√©n√©fices -->
      <div class="chart-container" style="margin-top:24px">
        <h3>üîÆ Pr√©visions de b√©n√©fices (12 mois)</h3>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:12px;padding:20px">
          <div style="text-align:center;padding:12px;background:var(--bg-secondary);border-radius:8px">
            <div style="font-size:11px;color:var(--muted);margin-bottom:6px">Mois 1</div>
            <div style="font-size:20px;font-weight:700;color:var(--success)" id="forecast1">5.5k‚Ç¨</div>
          </div>
          <div style="text-align:center;padding:12px;background:var(--bg-secondary);border-radius:8px">
            <div style="font-size:11px;color:var(--muted);margin-bottom:6px">Mois 3</div>
            <div style="font-size:20px;font-weight:700;color:var(--success)" id="forecast3">17k‚Ç¨</div>
          </div>
          <div style="text-align:center;padding:12px;background:var(--bg-secondary);border-radius:8px">
            <div style="font-size:11px;color:var(--muted);margin-bottom:6px">Mois 6</div>
            <div style="font-size:20px;font-weight:700;color:var(--success)" id="forecast6">35k‚Ç¨</div>
          </div>
          <div style="text-align:center;padding:12px;background:var(--bg-secondary);border-radius:8px;border:2px solid var(--accent)">
            <div style="font-size:11px;color:var(--muted);margin-bottom:6px">Mois 12</div>
            <div style="font-size:24px;font-weight:800;color:var(--accent)" id="forecast12">72k‚Ç¨</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Tab: Stock -->
    <div class="tab-content" id="tab-stock">
      <div class="stock-form">
        <h3>‚ûï Mouvement de stock</h3>
        <div class="stock-grid">
          <div>
            <label>Produit</label>
            <select id="stockProduct">
              <option value="">S√©lectionner...</option>
            </select>
          </div>
          <div>
            <label>Variant</label>
            <select id="stockVariant" disabled>
              <option value="">S√©lectionner...</option>
            </select>
          </div>
          <div>
            <label>Type</label>
            <select id="stockType">
              <option value="in">‚ûï Entr√©e</option>
              <option value="out">‚ûñ Sortie</option>
              <option value="adjust">‚öñÔ∏è Ajustement</option>
            </select>
          </div>
          <div>
            <label>Quantit√©</label>
            <input id="stockQty" type="number" min="1" value="1">
          </div>
          <div>
            <label>Prix unitaire (‚Ç¨)</label>
            <input id="stockPrice" type="number" step="0.01" placeholder="0.00">
          </div>
          <div>
            <label>Motif</label>
            <input id="stockReason" placeholder="Ex: R√©approvisionnement">
          </div>
        </div>
        <button id="addStockMovement">Ajouter le mouvement</button>
      </div>

      <div class="loading" id="stockLoading">
        <div class="spinner"></div>
      </div>

      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Produit</th>
              <th>Variant</th>
              <th>Stock</th>
              <th>Valeur</th>
              <th>Statut</th>
              <th>Derni√®re MAJ</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="stockTable"></tbody>
        </table>
      </div>
    </div>

    <!-- Tab: Products -->
    <div class="tab-content" id="tab-products">
      <div class="toolbar">
        <input type="text" id="searchProducts" placeholder="üîç Rechercher un produit...">
        <select id="filterCategory">
          <option value="all">Toutes cat√©gories</option>
          <option value="fleurs">üåø Fleurs</option>
          <option value="resines">üü´ R√©sines</option>
          <option value="edibles">üç™ Edibles</option>
        </select>
        <button onclick="addNewProduct()">‚ûï Nouveau produit</button>
        <button onclick="loadProducts()">üîÑ Actualiser</button>
      </div>

      <div class="loading" id="productsLoading">
        <div class="spinner"></div>
      </div>

      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>Nom</th>
              <th>Cat√©gorie</th>
              <th>Variants</th>
              <th>Prix Min</th>
              <th>Stock Total</th>
              <th>Statut</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="productsTable">
            <tr>
              <td colspan="8" class="empty-state">Chargement des produits...</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Tab: Customers -->
    <div class="tab-content" id="tab-customers">
      <div class="toolbar">
        <input type="text" id="searchCustomers" placeholder="üîç Rechercher un client...">
        <select id="filterCustomerType">
          <option value="all">Tous les clients</option>
          <option value="vip">‚≠ê VIP</option>
          <option value="regular">üë§ R√©gulier</option>
          <option value="new">üÜï Nouveau</option>
        </select>
        <button onclick="addNewCustomer()">‚ûï Nouveau client</button>
        <button onclick="exportCustomers()">üì• Exporter</button>
      </div>

      <div class="stats" style="margin-bottom:24px">
        <div class="stat-card">
          <h3>üë• Total clients</h3>
          <div class="value" id="totalCustomers">0</div>
        </div>
        <div class="stat-card">
          <h3>‚≠ê Clients VIP</h3>
          <div class="value" id="vipCustomers">0</div>
        </div>
        <div class="stat-card">
          <h3>üÜï Nouveaux ce mois</h3>
          <div class="value" id="newCustomers">0</div>
        </div>
        <div class="stat-card">
          <h3>üí∞ Valeur moyenne</h3>
          <div class="value" id="avgCustomerValue">0‚Ç¨</div>
        </div>
      </div>

      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>Nom</th>
              <th>Email</th>
              <th>T√©l√©phone</th>
              <th>Commandes</th>
              <th>Total d√©pens√©</th>
              <th>Statut</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="customersTable">
            <tr>
              <td colspan="8" class="empty-state">Chargement des clients...</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Tab: Analytics -->
    <div class="tab-content" id="tab-analytics">
      <div class="stats" style="margin-bottom:24px">
        <div class="stat-card">
          <h3>üìà Taux de conversion</h3>
          <div class="value">24.5%</div>
          <div class="trend up">
            <span>‚Üó</span>
            <span>+2.3% vs mois dernier</span>
          </div>
        </div>
        <div class="stat-card">
          <h3>üîÑ Taux de r√©tention</h3>
          <div class="value">67%</div>
          <div class="trend up">
            <span>‚Üó</span>
            <span>+5% vs mois dernier</span>
          </div>
        </div>
        <div class="stat-card">
          <h3>‚è±Ô∏è Temps moyen commande</h3>
          <div class="value">3.2 jours</div>
          <div class="trend down">
            <span>‚Üò</span>
            <span>-0.5 jour</span>
          </div>
        </div>
        <div class="stat-card">
          <h3>‚≠ê Note moyenne</h3>
          <div class="value">4.7/5</div>
          <div style="color:var(--warning);margin-top:8px">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
        </div>
      </div>

      <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:24px">
        <div class="chart-container">
          <h3>üìä Ventes par cat√©gorie</h3>
          <div id="categoryChart" style="padding:20px">
            <div style="margin-bottom:12px">
              <div style="display:flex;justify-content:space-between;margin-bottom:8px">
                <span>üåø Fleurs</span>
                <span style="color:var(--accent)">45%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" style="width:45%"></div>
              </div>
            </div>
            <div style="margin-bottom:12px">
              <div style="display:flex;justify-content:space-between;margin-bottom:8px">
                <span>üü´ R√©sines</span>
                <span style="color:var(--accent)">35%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" style="width:35%"></div>
              </div>
            </div>
            <div>
              <div style="display:flex;justify-content:space-between;margin-bottom:8px">
                <span>üç™ Edibles</span>
                <span style="color:var(--accent)">20%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" style="width:20%"></div>
              </div>
            </div>
          </div>
        </div>

        <div class="chart-container">
          <h3>üåç Ventes par zone</h3>
          <div id="zoneChart" style="padding:20px">
            <div style="margin-bottom:12px">
              <div style="display:flex;justify-content:space-between;margin-bottom:8px">
                <span>üìç Millau Centre</span>
                <span style="color:var(--accent)">60%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" style="width:60%"></div>
              </div>
            </div>
            <div style="margin-bottom:12px">
              <div style="display:flex;justify-content:space-between;margin-bottom:8px">
                <span>üìç P√©riph√©rie</span>
                <span style="color:var(--accent)">25%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" style="width:25%"></div>
              </div>
            </div>
            <div>
              <div style="display:flex;justify-content:space-between;margin-bottom:8px">
                <span>üìç Ext√©rieur</span>
                <span style="color:var(--accent)">15%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" style="width:15%"></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="chart-container">
        <h3>üìÖ Performance mensuelle</h3>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;padding:20px">
          <div style="text-align:center;padding:16px;background:var(--bg-secondary);border-radius:12px">
            <div style="font-size:12px;color:var(--muted);margin-bottom:8px">Janvier</div>
            <div style="font-size:24px;font-weight:700;color:var(--accent)">12.4k‚Ç¨</div>
            <div style="font-size:11px;color:var(--success)">+15%</div>
          </div>
          <div style="text-align:center;padding:16px;background:var(--bg-secondary);border-radius:12px">
            <div style="font-size:12px;color:var(--muted);margin-bottom:8px">F√©vrier</div>
            <div style="font-size:24px;font-weight:700;color:var(--accent)">14.2k‚Ç¨</div>
            <div style="font-size:11px;color:var(--success)">+8%</div>
          </div>
          <div style="text-align:center;padding:16px;background:var(--bg-secondary);border-radius:12px">
            <div style="font-size:12px;color:var(--muted);margin-bottom:8px">Mars</div>
            <div style="font-size:24px;font-weight:700;color:var(--accent)">11.8k‚Ç¨</div>
            <div style="font-size:11px;color:var(--danger)">-3%</div>
          </div>
          <div style="text-align:center;padding:16px;background:var(--bg-secondary);border-radius:12px">
            <div style="font-size:12px;color:var(--muted);margin-bottom:8px">Avril</div>
            <div style="font-size:24px;font-weight:700;color:var(--accent)">15.6k‚Ç¨</div>
            <div style="font-size:11px;color:var(--success)">+22%</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Tab: Settings -->
    <div class="tab-content" id="tab-settings">
      <div style="display:grid;grid-template-columns:250px 1fr;gap:24px">
        <!-- Settings Menu -->
        <div class="chart-container" style="padding:0">
          <div class="settings-menu">
            <div class="settings-menu-item active" onclick="showSettingsSection('general')">‚öôÔ∏è G√©n√©ral</div>
            <div class="settings-menu-item" onclick="showSettingsSection('security')">üîí S√©curit√©</div>
            <div class="settings-menu-item" onclick="showSettingsSection('notifications')">üîî Notifications</div>
            <div class="settings-menu-item" onclick="showSettingsSection('delivery')">üöö Livraison</div>
            <div class="settings-menu-item" onclick="showSettingsSection('payment')">üí≥ Paiement</div>
            <div class="settings-menu-item" onclick="showSettingsSection('backup')">üíæ Sauvegarde</div>
          </div>
        </div>

        <!-- Settings Content -->
        <div class="chart-container">
          <div id="settings-general" class="settings-section active">
            <h3>‚öôÔ∏è Param√®tres g√©n√©raux</h3>
            <div class="form-group">
              <label>Nom de la boutique</label>
              <input type="text" value="DROGUA CENTER" id="shopName">
            </div>
            <div class="form-group">
              <label>Email de contact</label>
              <input type="email" value="contact@drogua.center" id="shopEmail">
            </div>
            <div class="form-group">
              <label>T√©l√©phone</label>
              <input type="tel" value="06 12 34 56 78" id="shopPhone">
            </div>
            <div class="form-group">
              <label>Adresse</label>
              <textarea rows="3" id="shopAddress">12 Rue Example
12100 Millau
France</textarea>
            </div>
            <div class="form-group">
              <label>Fuseau horaire</label>
              <select id="timezone">
                <option value="Europe/Paris">Europe/Paris (UTC+1)</option>
                <option value="Europe/London">Europe/London (UTC+0)</option>
              </select>
            </div>
            <button onclick="saveSettings()">üíæ Sauvegarder</button>
          </div>

          <div id="settings-security" class="settings-section" style="display:none">
            <h3>üîí S√©curit√©</h3>
            <div class="form-group">
              <label>Ancien mot de passe</label>
              <input type="password" id="oldPassword">
            </div>
            <div class="form-group">
              <label>Nouveau mot de passe</label>
              <input type="password" id="newPassword">
            </div>
            <div class="form-group">
              <label>Confirmer le mot de passe</label>
              <input type="password" id="confirmPassword">
            </div>
            <div class="form-group">
              <label>
                <input type="checkbox" id="twoFactor" style="width:auto;margin-right:8px">
                Activer l'authentification √† deux facteurs
              </label>
            </div>
            <button onclick="updatePassword()">üîê Modifier le mot de passe</button>
          </div>

          <div id="settings-notifications" class="settings-section" style="display:none">
            <h3>üîî Notifications</h3>
            <div class="form-group">
              <label>
                <input type="checkbox" checked style="width:auto;margin-right:8px">
                Nouvelles commandes
              </label>
            </div>
            <div class="form-group">
              <label>
                <input type="checkbox" checked style="width:auto;margin-right:8px">
                Stock faible
              </label>
            </div>
            <div class="form-group">
              <label>
                <input type="checkbox" style="width:auto;margin-right:8px">
                Nouveaux avis
              </label>
            </div>
            <div class="form-group">
              <label>
                <input type="checkbox" checked style="width:auto;margin-right:8px">
                Alertes de s√©curit√©
              </label>
            </div>
            <button onclick="saveNotifications()">üíæ Sauvegarder</button>
          </div>

          <div id="settings-delivery" class="settings-section" style="display:none">
            <h3>üöö Param√®tres de livraison</h3>
            <div class="form-group">
              <label>Zone de livraison gratuite (km)</label>
              <input type="number" value="5" id="freeDeliveryZone">
            </div>
            <div class="form-group">
              <label>Frais de livraison standard (‚Ç¨)</label>
              <input type="number" value="5" id="standardDeliveryFee">
            </div>
            <div class="form-group">
              <label>Frais de livraison express (‚Ç¨)</label>
              <input type="number" value="10" id="expressDeliveryFee">
            </div>
            <div class="form-group">
              <label>D√©lai de livraison standard (heures)</label>
              <input type="number" value="24" id="standardDeliveryTime">
            </div>
            <button onclick="saveDeliverySettings()">üíæ Sauvegarder</button>
          </div>

          <div id="settings-payment" class="settings-section" style="display:none">
            <h3>üí≥ M√©thodes de paiement</h3>
            <div class="form-group">
              <label>
                <input type="checkbox" checked style="width:auto;margin-right:8px">
                Esp√®ces
              </label>
            </div>
            <div class="form-group">
              <label>
                <input type="checkbox" checked style="width:auto;margin-right:8px">
                Carte bancaire
              </label>
            </div>
            <div class="form-group">
              <label>
                <input type="checkbox" style="width:auto;margin-right:8px">
                PayPal
              </label>
            </div>
            <div class="form-group">
              <label>
                <input type="checkbox" checked style="width:auto;margin-right:8px">
                Crypto (Bitcoin, Ethereum)
              </label>
            </div>
            <button onclick="savePaymentSettings()">üíæ Sauvegarder</button>
          </div>

          <div id="settings-backup" class="settings-section" style="display:none">
            <h3>üíæ Sauvegarde & Export</h3>
            <div style="display:grid;gap:12px">
              <button onclick="exportAllData()">üì• Exporter toutes les donn√©es (JSON)</button>
              <button onclick="exportDatabaseSQL()">üì• Exporter base de donn√©es (SQL)</button>
              <button onclick="createBackup()">üíæ Cr√©er une sauvegarde</button>
              <button onclick="restoreBackup()" style="background:var(--warning)">üì§ Restaurer une sauvegarde</button>
              <button onclick="clearAllData()" style="background:var(--danger)">üóëÔ∏è Effacer toutes les donn√©es</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Toast Container -->
<div class="toast-container" id="toastContainer"></div>

<!-- Modals -->
<div class="modal" id="modalOrder">
  <div class="modal-content">
    <div class="modal-header">
      <h3>üì¶ D√©tails de la commande</h3>
      <button class="modal-close" onclick="closeModal('modalOrder')">‚úï</button>
    </div>
    <div class="modal-body" id="orderDetails"></div>
    <div class="modal-footer">
      <button onclick="printOrder()">üñ®Ô∏è Imprimer</button>
      <button onclick="closeModal('modalOrder')">Fermer</button>
    </div>
  </div>
</div>

<script>
// ===== Configuration =====
const CONFIG = {
  API_URL: 'https://api.example.com',
  USE_LOCAL: true,
  THEME_KEY: 'admin_theme',
  AUTH_KEY: 'admin_auth',
  VERSION: '2.0.0'
};

// ===== Product Price Presets (d√©clar√© une seule fois) =====
const PRODUCT_PRICES = {
  'amnesia': {
    name: 'AMNESIA',
    buyPrice: 1.2,
    variants: {
      3.33: 20,
      5: 30,
      10: 60,
      50: 250,
      100: 450
    }
  },
  'needles': {
    name: 'NEEDLES KETA',
    buyPrice: 4,
    variants: {
      1: 20,
      2: 40,
      3: 50,
      5: 80,
      10: 150
    }
  },
  'champagne': {
    name: 'CHAMPAGNE',
    buyPrice: 3.5,
    variants: {
      1: 20,
      2: 40,
      3: 50,
      5: 80,
      10: 150
    }
  },
  'eljefe': {
    name: 'EL JEFE',
    buyPrice: 14,
    variants: {
      0.5: 30,
      1: 50,
      2: 100,
      5: 250,
      10: 430
    }
  },
  'skittlez': {
    name: 'SKITTLEZ CAKE',
    buyPrice: 2,
    variants: {
      2.5: 20,
      5: 40,
      10: 70,
      50: 290
    }
  },
  'pistacchio': {
    name: 'PISTACCHIO',
    buyPrice: 1.8,
    variants: {
      3: 20,
      5: 50,
      10: 90,
      50: 250
    }
  },
  'dembele': {
    name: 'DEMBELE',
    buyPrice: 1.1,
    variants: {
      3.5: 20,
      5: 30,
      10: 50,
      50: 190,
      100: 370
    }
  },
  'lemon': {
    name: 'LEMON X GELATO',
    buyPrice: 3.4,
    variants: {
      1.66: 20,
      3.5: 40,
      5: 60,
      10: 110
    }
  },
  'georgia': {
    name: 'GEORGIA PIE',
    buyPrice: 3.4,
    variants: {
      1.66: 20,
      3.5: 40,
      5: 60,
      10: 110
    }
  },
  'domino': {
    name: 'DOMINO',
    buyPrice: 2.5,
    variants: {
      3: 20,
      10: 60,
      50: 150
    }
  },
  'fresh': {
    name: 'FRESH FROZEN',
    buyPrice: 3.2,
    variants: {
      1.1: 20,
      2.3: 40,
      3.5: 50,
      5: 80,
      10: 160
    }
  }
};

// ===== Simple Login Function =====
function handleLogin() {
  const password = document.getElementById('pass').value;
  const CORRECT_PASSWORD = 'gangstaforlife12';
  
  console.log('Tentative de connexion avec:', password);
  
  if (password === CORRECT_PASSWORD) {
    document.getElementById('auth').style.display = 'none';
    document.getElementById('dash').style.display = 'block';
    localStorage.setItem('isLoggedIn', 'true');
    showToast('Connexion r√©ussie !', 'success');
    initDashboard();
  } else {
    showToast('Mot de passe incorrect', 'error');
    document.getElementById('pass').value = '';
  }
}

// ===== Toast Notification =====
function showToast(message, type = 'success') {
  const container = document.getElementById('toastContainer');
  const toast = document.createElement('div');
  toast.className = `toast ${type} show`;
  toast.textContent = message;
  container.appendChild(toast);
  
  setTimeout(() => {
    toast.classList.remove('show');
    setTimeout(() => toast.remove(), 300);
  }, 3000);
}

// ===== Format Currency =====
function formatCurrency(amount) {
  return new Intl.NumberFormat('fr-FR', {
    style: 'currency',
    currency: 'EUR'
  }).format(amount || 0);
}

// ===== Format Date =====
function formatDate(date) {
  return new Intl.DateTimeFormat('fr-FR', {
    dateStyle: 'medium',
    timeStyle: 'short'
  }).format(new Date(date));
}

// ===== Initialize Dashboard =====
function initDashboard() {
  console.log('Initialisation du dashboard...');
  loadStats();
  initTabs();
  initTheme();
  loadDemoOrders();
  loadProducts();
  loadCustomers();
  loadFinances();
  loadStock();
  updateActivityFeed();
  updateQuickStats();
}

// ===== Load Stats =====
function loadStats() {
  document.getElementById('totalCA').textContent = formatCurrency(8750);
  document.getElementById('totalOrders').textContent = '42';
  document.getElementById('avgOrder').textContent = formatCurrency(208);
  document.getElementById('topProduct').textContent = 'AMNESIA';
  document.getElementById('topProductSales').textContent = '15 ventes';
  document.getElementById('stockValue').textContent = formatCurrency(12500);
  document.getElementById('stockItems').textContent = '324 articles';
  document.getElementById('stockAlerts').textContent = '3';
  document.getElementById('stockAlertDetails').innerHTML = '<span style="color:var(--danger)">2 ruptures</span> ‚Ä¢ <span style="color:var(--warning)">1 stock bas</span>';
  document.getElementById('progressCA').style.width = '65%';
  document.getElementById('trendCA').innerHTML = '<span>‚Üó</span><span>+12% vs mois dernier</span>';
}

// ===== Initialize Tabs =====
function initTabs() {
  document.querySelectorAll('.tab-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
      
      btn.classList.add('active');
      const tabId = `tab-${btn.dataset.tab}`;
      const tabContent = document.getElementById(tabId);
      if (tabContent) {
        tabContent.classList.add('active');
        
        switch(btn.dataset.tab) {
          case 'orders':
            loadDemoOrders();
            break;
          case 'finances':
            loadFinances();
            break;
          case 'stock':
            loadStock();
            break;
          case 'products':
            loadProducts();
            break;
          case 'customers':
            loadCustomers();
            break;
        }
      }
    });
  });
}

// ===== Initialize Theme =====
function initTheme() {
  const toggle = document.getElementById('themeToggle');
  if (toggle) {
    toggle.addEventListener('click', () => {
      const body = document.body;
      const currentTheme = body.getAttribute('data-theme');
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      body.setAttribute('data-theme', newTheme);
      toggle.classList.toggle('light', newTheme === 'light');
      localStorage.setItem('theme', newTheme);
    });
    
    const savedTheme = localStorage.getItem('theme') || 'dark';
    document.body.setAttribute('data-theme', savedTheme);
    toggle.classList.toggle('light', savedTheme === 'light');
  }
}

// ===== Load Demo Orders =====
function loadDemoOrders() {
  const orders = [
    {id: 1, date: new Date(), customer: 'Jean Dupont', items: 3, total: 120, status: 'pending', payment: 'Esp√®ces'},
    {id: 2, date: new Date(Date.now() - 86400000), customer: 'Marie Martin', items: 2, total: 85, status: 'delivered', payment: 'CB'},
    {id: 3, date: new Date(Date.now() - 172800000), customer: 'Paul Durand', items: 1, total: 50, status: 'processing', payment: 'Crypto'},
  ];
  
  const tbody = document.getElementById('ordersTable');
  if (tbody) {
    tbody.innerHTML = orders.map(order => `
      <tr>
        <td><strong>#${order.id}</strong></td>
        <td>${formatDate(order.date)}</td>
        <td>${order.customer}</td>
        <td>${order.items} articles</td>
        <td><strong>${formatCurrency(order.total)}</strong></td>
        <td>${getStatusBadge(order.status)}</td>
        <td><span class="badge">${order.payment}</span></td>
        <td class="actions">
          <button class="btn-sm btn-primary" onclick="viewOrder(${order.id})">üëÅÔ∏è</button>
          <button class="btn-sm btn-success" onclick="editOrder(${order.id})">‚úèÔ∏è</button>
          <button class="btn-sm btn-danger" onclick="deleteOrder(${order.id})">üóëÔ∏è</button>
        </td>
      </tr>
    `).join('');
  }
}

// ===== Get Status Badge =====
function getStatusBadge(status) {
  const badges = {
    pending: '<span class="badge warning">‚è≥ En attente</span>',
    processing: '<span class="badge info">üîÑ En traitement</span>',
    delivered: '<span class="badge success">‚úÖ Livr√©</span>',
    cancelled: '<span class="badge danger">‚ùå Annul√©</span>'
  };
  return badges[status] || badges.pending;
}

// ===== Update Activity Feed =====
function updateActivityFeed() {
  const activities = [
    { text: 'Nouvelle commande #123', time: 'Il y a 2 min', icon: 'üì¶' },
    { text: 'Stock AMNESIA mis √† jour', time: 'Il y a 5 min', icon: 'üìä' },
    { text: 'Nouvel avis 5‚≠ê sur EL JEFE', time: 'Il y a 12 min', icon: '‚≠ê' }
  ];
  
  const feed = document.getElementById('activityFeed');
  if (feed) {
    feed.innerHTML = activities.map(activity => `
      <div style="padding:12px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center">
        <div>
          <div style="font-weight:600">${activity.text}</div>
          <div style="font-size:12px;color:var(--muted);margin-top:4px">${activity.time}</div>
        </div>
        <span style="font-size:20px">${activity.icon}</span>
      </div>
    `).join('');
  }
}

// ===== Update Quick Stats =====
function updateQuickStats() {
  document.getElementById('todayRevenue').textContent = formatCurrency(450);
  document.getElementById('weekRevenue').textContent = formatCurrency(2340);
  document.getElementById('monthRevenue').textContent = formatCurrency(8750);
  document.getElementById('activeOrders').textContent = '5';
  document.getElementById('lowStock').textContent = '3';
  document.getElementById('pendingReviews').textContent = '2';
  
  document.getElementById('goalCA').textContent = '65%';
  document.getElementById('goalCABar').style.width = '65%';
  document.getElementById('goalOrders').textContent = '80%';
  document.getElementById('goalOrdersBar').style.width = '80%';
  document.getElementById('goalCustomers').textContent = '45%';
  document.getElementById('goalCustomersBar').style.width = '45%';
  
  const topProducts = document.getElementById('topProductsChart');
  if (topProducts) {
    topProducts.innerHTML = `
      <div style="padding:20px">
        <div style="margin-bottom:16px">
          <div style="display:flex;justify-content:space-between;margin-bottom:8px">
            <span>1. AMNESIA</span>
            <span style="color:var(--accent)">35 ventes</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" style="width:100%"></div>
          </div>
        </div>
        <div style="margin-bottom:16px">
          <div style="display:flex;justify-content:space-between;margin-bottom:8px">
            <span>2. EL JEFE</span>
            <span style="color:var(--accent)">28 ventes</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" style="width:80%"></div>
          </div>
        </div>
        <div style="margin-bottom:16px">
          <div style="display:flex;justify-content:space-between;margin-bottom:8px">
            <span>3. NEEDLES KETA</span>
            <span style="color:var(--accent)">22 ventes</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" style="width:63%"></div>
          </div>
        </div>
        <div style="margin-bottom:16px">
          <div style="display:flex;justify-content:space-between;margin-bottom:8px">
            <span>4. SKITTLEZ CAKE</span>
            <span style="color:var(--accent)">18 ventes</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" style="width:51%"></div>
          </div>
        </div>
        <div>
          <div style="display:flex;justify-content:space-between;margin-bottom:8px">
            <span>5. LEMON X GELATO</span>
            <span style="color:var(--accent)">15 ventes</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" style="width:43%"></div>
          </div>
        </div>
      </div>
    `;
  }
}

// ===== Load Products =====
function loadProducts() {
  const products = [
    {id: 1, name: 'AMNESIA', category: 'Fleurs', variants: 5, minPrice: 20, stock: 150, status: 'active'},
    {id: 2, name: 'NEEDLES KETA', category: 'R√©sines', variants: 5, minPrice: 20, stock: 85, status: 'active'},
    {id: 3, name: 'CHAMPAGNE', category: 'R√©sines', variants: 5, minPrice: 20, stock: 120, status: 'active'},
    {id: 4, name: 'EL JEFE', category: 'Fleurs', variants: 5, minPrice: 30, stock: 45, status: 'low'},
    {id: 5, name: 'SKITTLEZ CAKE 120u', category: 'R√©sines', variants: 4, minPrice: 20, stock: 95, status: 'active'},
    {id: 6, name: 'PISTACCHIO 73u', category: 'R√©sines', variants: 4, minPrice: 20, stock: 0, status: 'out'},
    {id: 7, name: 'DEMBELE', category: 'Fleurs', variants: 5, minPrice: 20, stock: 200, status: 'active'},
    {id: 8, name: 'LEMON X GELATO', category: 'Fleurs', variants: 4, minPrice: 20, stock: 65, status: 'active'},
    {id: 9, name: 'GEORGIA PIE', category: 'Fleurs', variants: 4, minPrice: 20, stock: 72, status: 'active'},
    {id: 10, name: 'DOMINO 280mg', category: 'Edibles', variants: 3, minPrice: 20, stock: 150, status: 'active'},
    {id: 11, name: 'FRESH FROZEN', category: 'R√©sines', variants: 5, minPrice: 20, stock: 30, status: 'low'}
  ];
  
  const tbody = document.getElementById('productsTable');
  if (tbody) {
    tbody.innerHTML = products.map(product => {
      let statusBadge = '';
      if (product.status === 'active') {
        statusBadge = '<span class="badge success">‚úÖ Actif</span>';
      } else if (product.status === 'low') {
        statusBadge = '<span class="badge warning">‚ö†Ô∏è Stock bas</span>';
      } else if (product.status === 'out') {
        statusBadge = '<span class="badge danger">‚ùå Rupture</span>';
      }
      
      return `
        <tr>
          <td><strong>#${product.id}</strong></td>
          <td><strong>${product.name}</strong></td>
          <td><span class="badge">${product.category}</span></td>
          <td>${product.variants}</td>
          <td>${formatCurrency(product.minPrice)}</td>
          <td>${product.stock} unit√©s</td>
          <td>${statusBadge}</td>
          <td class="actions">
            <button class="btn-sm btn-primary" onclick="editProduct(${product.id})">‚úèÔ∏è</button>
            <button class="btn-sm btn-success" onclick="viewProductStock(${product.id})">üìä</button>
            <button class="btn-sm btn-danger" onclick="deleteProduct(${product.id})">üóëÔ∏è</button>
          </td>
        </tr>
      `;
    }).join('');
  }
}

// ===== Load Customers =====
function loadCustomers() {
  const customers = [
    {id: 1, name: 'Jean Dupont', email: 'jean@email.com', phone: '06 12 34 56 78', orders: 12, totalSpent: 1450, status: 'vip'},
    {id: 2, name: 'Marie Martin', email: 'marie@email.com', phone: '06 98 76 54 32', orders: 5, totalSpent: 425, status: 'regular'},
    {id: 3, name: 'Paul Durand', email: 'paul@email.com', phone: '07 11 22 33 44', orders: 2, totalSpent: 150, status: 'new'},
    {id: 4, name: 'Sophie Bernard', email: 'sophie@email.com', phone: '06 55 66 77 88', orders: 8, totalSpent: 890, status: 'regular'},
    {id: 5, name: 'Luc Moreau', email: 'luc@email.com', phone: '07 99 88 77 66', orders: 15, totalSpent: 2100, status: 'vip'}
  ];
  
  document.getElementById('totalCustomers').textContent = customers.length;
  document.getElementById('vipCustomers').textContent = customers.filter(c => c.status === 'vip').length;
  document.getElementById('newCustomers').textContent = customers.filter(c => c.status === 'new').length;
  document.getElementById('avgCustomerValue').textContent = formatCurrency(customers.reduce((sum, c) => sum + c.totalSpent, 0) / customers.length);
  
  const tbody = document.getElementById('customersTable');
  if (tbody) {
    tbody.innerHTML = customers.map(customer => {
      let statusBadge = '';
      if (customer.status === 'vip') {
        statusBadge = '<span class="badge warning">‚≠ê VIP</span>';
      } else if (customer.status === 'regular') {
        statusBadge = '<span class="badge info">üë§ R√©gulier</span>';
      } else {
        statusBadge = '<span class="badge success">üÜï Nouveau</span>';
      }
      
      return `
        <tr>
          <td><strong>#${customer.id}</strong></td>
          <td><strong>${customer.name}</strong></td>
          <td>${customer.email}</td>
          <td>${customer.phone}</td>
          <td>${customer.orders}</td>
          <td><strong>${formatCurrency(customer.totalSpent)}</strong></td>
          <td>${statusBadge}</td>
          <td class="actions">
            <button class="btn-sm btn-primary" onclick="viewCustomer(${customer.id})">üëÅÔ∏è</button>
            <button class="btn-sm btn-success" onclick="sendMessage(${customer.id})">üí¨</button>
            <button class="btn-sm btn-danger" onclick="deleteCustomer(${customer.id})">üóëÔ∏è</button>
          </td>
        </tr>
      `;
    }).join('');
  }
}

// ===== Load Finances (TOUTE LA FONCTION) =====
function loadFinances() {
  const monthlyRevenue = 8750;
  const monthlyExpenses = 3200;
  const netProfit = monthlyRevenue - monthlyExpenses;
  const profitMargin = (netProfit / monthlyRevenue * 100).toFixed(1);
  const globalROI = ((netProfit / monthlyExpenses) * 100).toFixed(1);
  
  if (document.getElementById('monthlyRevenue')) {
    document.getElementById('monthlyRevenue').textContent = formatCurrency(monthlyRevenue);
    document.getElementById('monthlyExpenses').textContent = formatCurrency(monthlyExpenses);
    document.getElementById('netProfit').textContent = formatCurrency(netProfit);
    document.getElementById('profitMargin').textContent = profitMargin + '%';
    document.getElementById('globalROI').textContent = globalROI + '%';
    document.getElementById('mostProfitable').textContent = 'EL JEFE';
    document.getElementById('mostProfitableMargin').textContent = '285% de marge';
  }
  
  loadProfitabilityTable();
  loadTopProfitableProducts();
}

// ===== Profitability Table =====
function loadProfitabilityTable() {
  const products = [
    {name: 'AMNESIA', variant: '5G', buyPrice: 6, sellPrice: 30, profit: 24, margin: 400, sales: 35, monthlyProfit: 840, roi: 400},
    {name: 'AMNESIA', variant: '10G', buyPrice: 12, sellPrice: 60, profit: 48, margin: 400, sales: 22, monthlyProfit: 1056, roi: 400},
    {name: 'NEEDLES KETA', variant: '2G', buyPrice: 8, sellPrice: 40, profit: 32, margin: 400, sales: 18, monthlyProfit: 576, roi: 400},
    {name: 'EL JEFE', variant: '1G', buyPrice: 14, sellPrice: 50, profit: 36, margin: 257, sales: 28, monthlyProfit: 1008, roi: 257},
    {name: 'EL JEFE', variant: '2G', buyPrice: 28, sellPrice: 100, profit: 72, margin: 257, sales: 15, monthlyProfit: 1080, roi: 257},
    {name: 'SKITTLEZ CAKE', variant: '5G', buyPrice: 10, sellPrice: 40, profit: 30, margin: 300, sales: 20, monthlyProfit: 600, roi: 300},
    {name: 'DEMBELE', variant: '10G', buyPrice: 11, sellPrice: 50, profit: 39, margin: 355, sales: 30, monthlyProfit: 1170, roi: 355},
    {name: 'LEMON X GELATO', variant: '3.5G', buyPrice: 12, sellPrice: 40, profit: 28, margin: 233, sales: 16, monthlyProfit: 448, roi: 233},
    {name: 'FRESH FROZEN', variant: '5G', buyPrice: 16, sellPrice: 80, profit: 64, margin: 400, sales: 12, monthlyProfit: 768, roi: 400}
  ];
  
  const tbody = document.getElementById('profitabilityTable');
  if (tbody) {
    tbody.innerHTML = products.map(product => {
      const marginColor = product.margin >= 300 ? 'var(--success)' : product.margin >= 200 ? 'var(--warning)' : 'var(--danger)';
      const roiColor = product.roi >= 300 ? 'var(--success)' : product.roi >= 200 ? 'var(--warning)' : 'var(--danger)';
      
      return `
        <tr>
          <td><strong>${product.name}</strong></td>
          <td>${product.variant}</td>
          <td style="color:var(--danger)">${formatCurrency(product.buyPrice)}</td>
          <td style="color:var(--accent)">${formatCurrency(product.sellPrice)}</td>
          <td style="color:var(--success);font-weight:600">+${formatCurrency(product.profit)}</td>
          <td><span style="color:${marginColor};font-weight:700">${product.margin}%</span></td>
          <td>${product.sales}</td>
          <td style="color:var(--success);font-weight:700">${formatCurrency(product.monthlyProfit)}</td>
          <td><span class="badge" style="background:${roiColor}20;color:${roiColor}">${product.roi}%</span></td>
        </tr>
      `;
    }).join('');
    
    const totalMonthlyProfit = products.reduce((sum, p) => sum + p.monthlyProfit, 0);
    const avgMargin = (products.reduce((sum, p) => sum + p.margin, 0) / products.length).toFixed(0);
    const avgROI = (products.reduce((sum, p) => sum + p.roi, 0) / products.length).toFixed(0);
    
    tbody.innerHTML += `
      <tr style="background:var(--bg-secondary);font-weight:700">
        <td colspan="2">TOTAL / MOYENNE</td>
        <td>-</td>
        <td>-</td>
        <td>-</td>
        <td style="color:var(--warning)">${avgMargin}%</td>
        <td>-</td>
        <td style="color:var(--success);font-size:18px">${formatCurrency(totalMonthlyProfit)}</td>
        <td style="color:var(--accent)">${avgROI}%</td>
      </tr>
    `;
  }
}

// ===== Load Top Profitable Products =====
function loadTopProfitableProducts() {
  const topProducts = [
    {name: 'AMNESIA 10G', margin: 400, monthlyProfit: 1056},
    {name: 'EL JEFE 2G', margin: 257, monthlyProfit: 1080},
    {name: 'DEMBELE 10G', margin: 355, monthlyProfit: 1170},
    {name: 'AMNESIA 5G', margin: 400, monthlyProfit: 840},
    {name: 'FRESH FROZEN 5G', margin: 400, monthlyProfit: 768}
  ];
  
  const container = document.getElementById('topProfitableProducts');
  if (container) {
    container.innerHTML = topProducts.map((product, index) => `
      <div style="margin-bottom:16px;padding:12px;background:var(--bg-secondary);border-radius:8px;display:flex;justify-content:space-between;align-items:center">
        <div style="display:flex;align-items:center;gap:12px">
          <span style="font-size:20px;font-weight:700;color:var(--muted)">#${index + 1}</span>
          <div>
            <div style="font-weight:600">${product.name}</div>
            <div style="font-size:12px;color:var(--muted)">Marge: ${product.margin}%</div>
          </div>
        </div>
        <div style="text-align:right">
          <div style="font-size:18px;font-weight:700;color:var(--success)">${formatCurrency(product.monthlyProfit)}</div>
          <div style="font-size:11px;color:var(--muted)">/mois</div>
        </div>
      </div>
    `).join('');
  }
}

// ===== Profit Calculation =====
function updateProfitCalculation() {
  const product = document.getElementById('calcProduct').value;
  const quantity = parseFloat(document.getElementById('calcQuantity').value) || 0;
  const buyPrice = parseFloat(document.getElementById('calcBuyPrice').value) || 0;
  const sellPrice = parseFloat(document.getElementById('calcSellPrice').value) || 0;
  const salesCount = parseInt(document.getElementById('calcSalesCount').value) || 1;
  
  if (product && quantity && buyPrice && sellPrice) {
    const totalBuyCost = buyPrice * quantity;
    const unitProfit = sellPrice - totalBuyCost;
    const margin = ((unitProfit / sellPrice) * 100).toFixed(1);
    const totalRevenue = sellPrice * salesCount;
    const totalProfit = unitProfit * salesCount;
    
    document.getElementById('resultBuyCost').textContent = formatCurrency(totalBuyCost);
    document.getElementById('resultSellPrice').textContent = formatCurrency(sellPrice);
    document.getElementById('resultUnitProfit').textContent = formatCurrency(unitProfit);
    document.getElementById('resultMargin').textContent = margin + '%';
    document.getElementById('resultTotalRevenue').textContent = formatCurrency(totalRevenue);
    document.getElementById('resultTotalProfit').textContent = formatCurrency(totalProfit);
    
    const costPercentage = (totalBuyCost / sellPrice * 100).toFixed(0);
    const profitPercentage = (unitProfit / sellPrice * 100).toFixed(0);
    document.getElementById('costBar').style.width = costPercentage + '%';
    document.getElementById('profitBar').style.width = profitPercentage + '%';
    document.getElementById('profitRatio').textContent = margin + '% de marge';
    
    const profitElement = document.getElementById('resultTotalProfit');
    const marginElement = document.getElementById('resultMargin');
    
    if (margin >= 200) {
      profitElement.style.color = 'var(--success)';
      marginElement.style.color = 'var(--success)';
    } else if (margin >= 100) {
      profitElement.style.color = 'var(--warning)';
      marginElement.style.color = 'var(--warning)';
    } else {
      profitElement.style.color = 'var(--danger)';
      marginElement.style.color = 'var(--danger)';
    }
    
    document.getElementById('profitResults').style.display = 'block';
  } else {
    document.getElementById('profitResults').style.display = 'none';
  }
}

// ===== Simulate Price Strategy =====
function simulatePriceStrategy(increase) {
  const increasePercent = parseFloat(increase);
  document.getElementById('priceIncreaseValue').textContent = increasePercent > 0 ? '+' + increasePercent : increasePercent;
  
  const baseRevenue = 8750;
  const baseProfit = 5550;
  const baseMargin = 63.4;
  
  const revenueImpact = (baseRevenue * increasePercent / 100);
  const profitImpact = revenueImpact;
  const newMargin = baseMargin + (increasePercent * 0.8);
  
  const revenueElement = document.getElementById('revenueImpact');
  const profitElement = document.getElementById('profitImpact');
  const marginElement = document.getElementById('newMargin');
  
  revenueElement.textContent = (revenueImpact >= 0 ? '+' : '') + formatCurrency(revenueImpact);
  profitElement.textContent = (profitImpact >= 0 ? '+' : '') + formatCurrency(profitImpact);
  marginElement.textContent = newMargin.toFixed(1) + '%';
  
  if (increasePercent > 0) {
    revenueElement.style.color = 'var(--success)';
    profitElement.style.color = 'var(--success)';
  } else if (increasePercent < 0) {
    revenueElement.style.color = 'var(--danger)';
    profitElement.style.color = 'var(--danger)';
  } else {
    revenueElement.style.color = 'var(--accent)';
    profitElement.style.color = 'var(--accent)';
  }
}

// ===== Load Stock =====
function loadStock() {
  const stockData = [
    {product: 'AMNESIA', variant: '5G', stock: 45, value: 1350, status: 'ok', lastUpdate: new Date()},
    {product: 'NEEDLES KETA', variant: '2G', stock: 30, value: 1200, status: 'ok', lastUpdate: new Date()},
    {product: 'EL JEFE', variant: '1G', stock: 8, value: 400, status: 'low', lastUpdate: new Date()},
    {product: 'SKITTLEZ CAKE', variant: '10G', stock: 0, value: 0, status: 'out', lastUpdate: new Date()},
    {product: 'LEMON X GELATO', variant: '3.5G', stock: 25, value: 1000, status: 'ok', lastUpdate: new Date()}
  ];
  
  const productSelect = document.getElementById('stockProduct');
  if (productSelect && productSelect.options.length <= 1) {
    const products = ['AMNESIA', 'NEEDLES KETA', 'CHAMPAGNE', 'EL JEFE', 'SKITTLEZ CAKE', 'PISTACCHIO', 'DEMBELE', 'LEMON X GELATO', 'GEORGIA PIE', 'DOMINO', 'FRESH FROZEN'];
    products.forEach(product => {
      const option = document.createElement('option');
      option.value = product;
      option.textContent = product;
      productSelect.appendChild(option);
    });
    
    productSelect.addEventListener('change', (e) => {
      const variantSelect = document.getElementById('stockVariant');
      if (e.target.value) {
        variantSelect.disabled = false;
        variantSelect.innerHTML = '<option value="">S√©lectionner...</option>';
        const variants = ['1G', '2G', '3G', '3.5G', '5G', '10G', '50G', '100G'];
        variants.forEach(variant => {
          const option = document.createElement('option');
          option.value = variant;
          option.textContent = variant;
          variantSelect.appendChild(option);
        });
      } else {
        variantSelect.disabled = true;
      }
    });
  }
  
  const tbody = document.getElementById('stockTable');
  if (tbody) {
    tbody.innerHTML = stockData.map(item => {
      let statusBadge = '';
      if (item.status === 'ok') {
        statusBadge = '<span class="badge success">‚úÖ OK</span>';
      } else if (item.status === 'low') {
        statusBadge = '<span class="badge warning">‚ö†Ô∏è Stock bas</span>';
      } else {
        statusBadge = '<span class="badge danger">‚ùå Rupture</span>';
      }
      
      return `
        <tr>
          <td><strong>${item.product}</strong></td>
          <td>${item.variant}</td>
          <td><strong style="color:var(--accent)">${item.stock}</strong></td>
          <td>${formatCurrency(item.value)}</td>
          <td>${statusBadge}</td>
          <td>${formatDate(item.lastUpdate)}</td>
          <td class="actions">
            <button class="btn-sm btn-success" onclick="quickAddStock('${item.product}', '${item.variant}')">‚ûï Ajouter</button>
            <button class="btn-sm btn-warning" onclick="adjustStock('${item.product}', '${item.variant}')">‚öñÔ∏è Ajuster</button>
          </td>
        </tr>
      `;
    }).join('');
  }
}

// ===== Settings Functions =====
function showSettingsSection(section) {
  document.querySelectorAll('.settings-section').forEach(s => {
    s.style.display = 'none';
    s.classList.remove('active');
  });
  
  const selectedSection = document.getElementById(`settings-${section}`);
  if (selectedSection) {
    selectedSection.style.display = 'block';
    selectedSection.classList.add('active');
  }
  
  document.querySelectorAll('.settings-menu-item').forEach(item => {
    item.classList.remove('active');
  });
  event.target.classList.add('active');
}

// ===== All Other Functions (Suite) =====
function closeModal(modalId) {
  const modal = document.getElementById(modalId);
  if (modal) modal.classList.remove('active');
}

function logout() {
  localStorage.removeItem('isLoggedIn');
  location.reload();
}

function viewOrder(id) {
  showToast('Affichage de la commande #' + id);
}

function editOrder(id) {
  showToast('√âdition de la commande #' + id);
}

function deleteOrder(id) {
  if (confirm('Supprimer cette commande ?')) {
    showToast('Commande supprim√©e', 'success');
  }
}

function editProduct(id) {
  showToast(`√âdition du produit #${id}`);
}

function viewProductStock(id) {
  showToast(`Affichage du stock produit #${id}`);
}

function deleteProduct(id) {
  if (confirm('Supprimer ce produit ?')) {
    showToast('Produit supprim√©', 'success');
    loadProducts();
  }
}

function addNewProduct() {
  showToast('Ouverture du formulaire d\'ajout');
}

function viewCustomer(id) {
  showToast(`Affichage du client #${id}`);
}

function sendMessage(id) {
  showToast(`Envoi d'un message au client #${id}`);
}

function deleteCustomer(id) {
  if (confirm('Supprimer ce client ?')) {
    showToast('Client supprim√©', 'success');
    loadCustomers();
  }
}

function addNewCustomer() {
  showToast('Ouverture du formulaire d\'ajout client');
}

function exportCustomers() {
  showToast('Export des clients en cours...');
}

function quickAddStock(product, variant) {
  const qty = prompt(`Quantit√© √† ajouter pour ${product} - ${variant}:`, '10');
  if (qty && !isNaN(qty)) {
    showToast(`Ajout de ${qty} unit√©s`, 'success');
    loadStock();
  }
}

function adjustStock(product, variant) {
  const newQty = prompt(`Nouveau stock pour ${product} - ${variant}:`, '0');
  if (newQty && !isNaN(newQty)) {
    showToast('Stock ajust√©', 'success');
    loadStock();
  }
}

function saveSettings() {
  showToast('Param√®tres sauvegard√©s', 'success');
}

function updatePassword() {
  const oldPass = document.getElementById('oldPassword').value;
  const newPass = document.getElementById('newPassword').value;
  const confirmPass = document.getElementById('confirmPassword').value;
  
  if (newPass !== confirmPass) {
    showToast('Les mots de passe ne correspondent pas', 'error');
    return;
  }
  
  if (newPass.length < 8) {
    showToast('Le mot de passe doit contenir au moins 8 caract√®res', 'error');
    return;
  }
  
  showToast('Mot de passe mis √† jour', 'success');
}

function saveNotifications() {
  showToast('Pr√©f√©rences de notifications sauvegard√©es', 'success');
}

function saveDeliverySettings() {
  showToast('Param√®tres de livraison sauvegard√©s', 'success');
}

function savePaymentSettings() {
  showToast('M√©thodes de paiement sauvegard√©es', 'success');
}

function exportDatabaseSQL() {
  showToast('Export SQL en cours...', 'success');
}

function createBackup() {
  showToast('Cr√©ation de la sauvegarde...', 'success');
}

function restoreBackup() {
  if (confirm('Restaurer une sauvegarde √©crasera toutes les donn√©es actuelles. Continuer ?')) {
    showToast('Restauration en cours...', 'warning');
  }
}

function clearAllData() {
  if (confirm('‚ö†Ô∏è ATTENTION : Cette action supprimera TOUTES les donn√©es. √ätes-vous s√ªr ?')) {
    if (confirm('‚ö†Ô∏è DERNI√àRE CONFIRMATION : Toutes les donn√©es seront perdues d√©finitivement !')) {
      localStorage.clear();
      showToast('Toutes les donn√©es ont √©t√© supprim√©es', 'success');
      setTimeout(() => location.reload(), 2000);
    }
  }
}

function showProfile() {
  showToast('Ouverture du profil administrateur');
}

function showSettings() {
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
  
  const settingsTab = document.querySelector('[data-tab="settings"]');
  const settingsContent = document.getElementById('tab-settings');
  
  if (settingsTab && settingsContent) {
    settingsTab.classList.add('active');
    settingsContent.classList.add('active');
  }
  
  document.querySelectorAll('.dropdown').forEach(d => d.classList.remove('active'));
}

function exportAllData() {
  const data = {
    orders: [],
    products: [],
    customers: [],
    stock: [],
    finances: [],
    exportDate: new Date().toISOString(),
    version: '2.0.0'
  };
  
  const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `drogua_export_${Date.now()}.json`;
  a.click();
  
  showToast('Export complet r√©ussi', 'success');
}

// ===== Page Load =====
document.addEventListener('DOMContentLoaded', () => {
  console.log('Page charg√©e - Mot de passe: gangstaforlife12');
  
  if (localStorage.getItem('isLoggedIn') === 'true') {
    document.getElementById('auth').style.display = 'none';
    document.getElementById('dash').style.display = 'block';
    initDashboard();
  } else {
    document.getElementById('auth').style.display = 'block';
    document.getElementById('dash').style.display = 'none';
  }
  
  document.getElementById('pass')?.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
      handleLogin();
    }
  });
  
  const userMenu = document.getElementById('userMenu');
  if (userMenu) {
    userMenu.addEventListener('click', (e) => {
      e.stopPropagation();
      const dropdown = e.target.closest('.dropdown');
      if (dropdown) dropdown.classList.toggle('active');
    });
  }
  
  document.addEventListener('click', () => {
    document.querySelectorAll('.dropdown').forEach(d => d.classList.remove('active'));
  });
  
  // Calculateur event listeners
  const calcProduct = document.getElementById('calcProduct');
  if (calcProduct) {
    calcProduct.addEventListener('change', function(e) {
      const product = e.target.value;
      if (product && PRODUCT_PRICES[product]) {
        const buyPriceField = document.getElementById('calcBuyPrice');
        if (!buyPriceField.value) {
          buyPriceField.value = PRODUCT_PRICES[product].buyPrice;
        }
        
        const quantitySelect = document.getElementById('calcQuantity');
        const variants = Object.keys(PRODUCT_PRICES[product].variants);
        
        quantitySelect.innerHTML = '<option value="">S√©lectionner</option>';
        variants.forEach(variant => {
          const option = document.createElement('option');
          option.value = variant;
          option.textContent = variant + (product === 'domino' ? ' unit√©s' : 'G');
          quantitySelect.appendChild(option);
        });
      }
    });
  }
  
  const calcQuantity = document.getElementById('calcQuantity');
  if (calcQuantity) {
    calcQuantity.addEventListener('change', function(e) {
      const product = document.getElementById('calcProduct').value;
      const quantity = parseFloat(e.target.value);
      
      if (product && quantity && PRODUCT_PRICES[product]) {
        const sellPriceField = document.getElementById('calcSellPrice');
        if (PRODUCT_PRICES[product].variants[quantity]) {
          sellPriceField.value = PRODUCT_PRICES[product].variants[quantity];
          updateProfitCalculation();
        }
      }
    });
  }
  
  const addStockBtn = document.getElementById('addStockMovement');
  if (addStockBtn) {
    addStockBtn.addEventListener('click', () => {
      const product = document.getElementById('stockProduct').value;
      const variant = document.getElementById('stockVariant').value;
      const type = document.getElementById('stockType').value;
      const qty = document.getElementById('stockQty').value;
      
      if (!product || !variant || !qty) {
        showToast('Veuillez remplir tous les champs obligatoires', 'error');
        return;
      }
      
      const typeText = type === 'in' ? 'Entr√©e' : type === 'out' ? 'Sortie' : 'Ajustement';
      showToast(`${typeText} de ${qty} ${product} ${variant} enregistr√©e`, 'success');
      
      document.getElementById('stockProduct').value = '';
      document.getElementById('stockVariant').value = '';
      document.getElementById('stockVariant').disabled = true;
      document.getElementById('stockQty').value = '1';
      
      loadStock();
    });
  }
});
</script>
function handleLogin() {
  const password = document.getElementById('pass').value;
  const CORRECT_PASSWORD = 'gangstaforlife12';
  
  console.log('Tentative de connexion avec:', password);
  
  if (password === CORRECT_PASSWORD) {
    // Connexion r√©ussie
    document.getElementById('auth').style.display = 'none';
    document.getElementById('dash').style.display = 'block';
    
    // Sauvegarder l'authentification
    localStorage.setItem('isLoggedIn', 'true');
    
    // Afficher le toast de succ√®s
    showToast('Connexion r√©ussie !', 'success');
    
    // Initialiser le dashboard
    initDashboard();
  } else {
    // Mot de passe incorrect
    showToast('Mot de passe incorrect', 'error');
    document.getElementById('pass').value = '';
  }
}

// ===== Toast Notification Simple =====
function showToast(message, type = 'success') {
  const container = document.getElementById('toastContainer');
  const toast = document.createElement('div');
  toast.className = `toast ${type} show`;
  toast.textContent = message;
  
  container.appendChild(toast);
  
  setTimeout(() => {
    toast.classList.remove('show');
    setTimeout(() => toast.remove(), 300);
  }, 3000);
}

// ===== Format Currency =====
function formatCurrency(amount) {
  return new Intl.NumberFormat('fr-FR', {
    style: 'currency',
    currency: 'EUR'
  }).format(amount || 0);
}

// ===== Format Date =====
function formatDate(date) {
  return new Intl.DateTimeFormat('fr-FR', {
    dateStyle: 'medium',
    timeStyle: 'short'
  }).format(new Date(date));
}

// ===== Initialize Dashboard =====
function initDashboard() {
  console.log('Initialisation du dashboard...');
  
  // Load demo stats
  loadStats();
  
  // Initialize tabs
  initTabs();
  
  // Initialize theme toggle
  initTheme();
  
  // Load all sections with demo data
  loadDemoOrders();
  loadProducts();
  loadCustomers();
  loadFinances();
  loadStock();
  
  // Initialize activity feed
  updateActivityFeed();
  
  // Initialize quick stats
  updateQuickStats();
}

// ===== Load Products =====
function loadProducts() {
  const products = [
    {id: 1, name: 'AMNESIA', category: 'Fleurs', variants: 5, minPrice: 20, stock: 150, status: 'active'},
    {id: 2, name: 'NEEDLES KETA', category: 'R√©sines', variants: 5, minPrice: 20, stock: 85, status: 'active'},
    {id: 3, name: 'CHAMPAGNE', category: 'R√©sines', variants: 5, minPrice: 20, stock: 120, status: 'active'},
    {id: 4, name: 'EL JEFE', category: 'Fleurs', variants: 5, minPrice: 30, stock: 45, status: 'low'},
    {id: 5, name: 'SKITTLEZ CAKE 120u', category: 'R√©sines', variants: 4, minPrice: 20, stock: 95, status: 'active'},
    {id: 6, name: 'PISTACCHIO 73u', category: 'R√©sines', variants: 4, minPrice: 20, stock: 0, status: 'out'},
    {id: 7, name: 'DEMBELE', category: 'Fleurs', variants: 5, minPrice: 20, stock: 200, status: 'active'},
    {id: 8, name: 'LEMON X GELATO', category: 'Fleurs', variants: 4, minPrice: 20, stock: 65, status: 'active'},
    {id: 9, name: 'GEORGIA PIE', category: 'Fleurs', variants: 4, minPrice: 20, stock: 72, status: 'active'},
    {id: 10, name: 'DOMINO 280mg', category: 'Edibles', variants: 3, minPrice: 20, stock: 150, status: 'active'},
    {id: 11, name: 'FRESH FROZEN', category: 'R√©sines', variants: 5, minPrice: 20, stock: 30, status: 'low'}
  ];
  
  const tbody = document.getElementById('productsTable');
  if (tbody) {
    tbody.innerHTML = products.map(product => {
      let statusBadge = '';
      if (product.status === 'active') {
        statusBadge = '<span class="badge success">‚úÖ Actif</span>';
      } else if (product.status === 'low') {
        statusBadge = '<span class="badge warning">‚ö†Ô∏è Stock bas</span>';
      } else if (product.status === 'out') {
        statusBadge = '<span class="badge danger">‚ùå Rupture</span>';
      }
      
      return `
        <tr>
          <td><strong>#${product.id}</strong></td>
          <td><strong>${product.name}</strong></td>
          <td><span class="badge">${product.category}</span></td>
          <td>${product.variants}</td>
          <td>${formatCurrency(product.minPrice)}</td>
          <td>${product.stock} unit√©s</td>
          <td>${statusBadge}</td>
          <td class="actions">
            <button class="btn-sm btn-primary" onclick="editProduct(${product.id})">‚úèÔ∏è</button>
            <button class="btn-sm btn-success" onclick="viewProductStock(${product.id})">üìä</button>
            <button class="btn-sm btn-danger" onclick="deleteProduct(${product.id})">üóëÔ∏è</button>
          </td>
        </tr>
      `;
    }).join('');
  }
}

// ===== Load Customers =====
function loadCustomers() {
  const customers = [
    {id: 1, name: 'Jean Dupont', email: 'jean@email.com', phone: '06 12 34 56 78', orders: 12, totalSpent: 1450, status: 'vip'},
    {id: 2, name: 'Marie Martin', email: 'marie@email.com', phone: '06 98 76 54 32', orders: 5, totalSpent: 425, status: 'regular'},
    {id: 3, name: 'Paul Durand', email: 'paul@email.com', phone: '07 11 22 33 44', orders: 2, totalSpent: 150, status: 'new'},
    {id: 4, name: 'Sophie Bernard', email: 'sophie@email.com', phone: '06 55 66 77 88', orders: 8, totalSpent: 890, status: 'regular'},
    {id: 5, name: 'Luc Moreau', email: 'luc@email.com', phone: '07 99 88 77 66', orders: 15, totalSpent: 2100, status: 'vip'}
  ];
  
  // Update stats
  document.getElementById('totalCustomers').textContent = customers.length;
  document.getElementById('vipCustomers').textContent = customers.filter(c => c.status === 'vip').length;
  document.getElementById('newCustomers').textContent = customers.filter(c => c.status === 'new').length;
  document.getElementById('avgCustomerValue').textContent = formatCurrency(customers.reduce((sum, c) => sum + c.totalSpent, 0) / customers.length);
  
  const tbody = document.getElementById('customersTable');
  if (tbody) {
    tbody.innerHTML = customers.map(customer => {
      let statusBadge = '';
      if (customer.status === 'vip') {
        statusBadge = '<span class="badge warning">‚≠ê VIP</span>';
      } else if (customer.status === 'regular') {
        statusBadge = '<span class="badge info">üë§ R√©gulier</span>';
      } else {
        statusBadge = '<span class="badge success">üÜï Nouveau</span>';
      }
      
      return `
        <tr>
          <td><strong>#${customer.id}</strong></td>
          <td><strong>${customer.name}</strong></td>
          <td>${customer.email}</td>
          <td>${customer.phone}</td>
          <td>${customer.orders}</td>
          <td><strong>${formatCurrency(customer.totalSpent)}</strong></td>
          <td>${statusBadge}</td>
          <td class="actions">
            <button class="btn-sm btn-primary" onclick="viewCustomer(${customer.id})">üëÅÔ∏è</button>
            <button class="btn-sm btn-success" onclick="sendMessage(${customer.id})">üí¨</button>
            <button class="btn-sm btn-danger" onclick="deleteCustomer(${customer.id})">üóëÔ∏è</button>
          </td>
        </tr>
      `;
    }).join('');
  }
}

// ===== Load Finances =====
function loadFinances() {
  // Demo finance data
  const monthlyRevenue = 8750;
  const monthlyExpenses = 3200;
  const netProfit = monthlyRevenue - monthlyExpenses;
  const profitMargin = (netProfit / monthlyRevenue * 100).toFixed(1);
  const globalROI = ((netProfit / monthlyExpenses) * 100).toFixed(1);
  
  if (document.getElementById('monthlyRevenue')) {
    document.getElementById('monthlyRevenue').textContent = formatCurrency(monthlyRevenue);
    document.getElementById('monthlyExpenses').textContent = formatCurrency(monthlyExpenses);
    document.getElementById('netProfit').textContent = formatCurrency(netProfit);
    document.getElementById('profitMargin').textContent = profitMargin + '%';
    document.getElementById('globalROI').textContent = globalROI + '%';
    document.getElementById('mostProfitable').textContent = 'EL JEFE';
    document.getElementById('mostProfitableMargin').textContent = '285% de marge';
  }
  
  // Load profitability table
  loadProfitabilityTable();
  
  // Load top profitable products
  loadTopProfitableProducts();
}

// ===== Profitability Table =====
function loadProfitabilityTable() {
  const products = [
    {name: 'AMNESIA', variant: '5G', buyPrice: 6, sellPrice: 30, profit: 24, margin: 400, sales: 35, monthlyProfit: 840, roi: 400},
    {name: 'AMNESIA', variant: '10G', buyPrice: 12, sellPrice: 60, profit: 48, margin: 400, sales: 22, monthlyProfit: 1056, roi: 400},
    {name: 'NEEDLES KETA', variant: '2G', buyPrice: 8, sellPrice: 40, profit: 32, margin: 400, sales: 18, monthlyProfit: 576, roi: 400},
    {name: 'EL JEFE', variant: '1G', buyPrice: 14, sellPrice: 50, profit: 36, margin: 257, sales: 28, monthlyProfit: 1008, roi: 257},
    {name: 'EL JEFE', variant: '2G', buyPrice: 28, sellPrice: 100, profit: 72, margin: 257, sales: 15, monthlyProfit: 1080, roi: 257},
    {name: 'SKITTLEZ CAKE', variant: '5G', buyPrice: 10, sellPrice: 40, profit: 30, margin: 300, sales: 20, monthlyProfit: 600, roi: 300},
    {name: 'DEMBELE', variant: '10G', buyPrice: 11, sellPrice: 50, profit: 39, margin: 355, sales: 30, monthlyProfit: 1170, roi: 355},
    {name: 'LEMON X GELATO', variant: '3.5G', buyPrice: 12, sellPrice: 40, profit: 28, margin: 233, sales: 16, monthlyProfit: 448, roi: 233},
    {name: 'FRESH FROZEN', variant: '5G', buyPrice: 16, sellPrice: 80, profit: 64, margin: 400, sales: 12, monthlyProfit: 768, roi: 400}
  ];
  
  const tbody = document.getElementById('profitabilityTable');
  if (tbody) {
    tbody.innerHTML = products.map(product => {
      const marginColor = product.margin >= 300 ? 'var(--success)' : product.margin >= 200 ? 'var(--warning)' : 'var(--danger)';
      const roiColor = product.roi >= 300 ? 'var(--success)' : product.roi >= 200 ? 'var(--warning)' : 'var(--danger)';
      
      return `
        <tr>
          <td><strong>${product.name}</strong></td>
          <td>${product.variant}</td>
          <td style="color:var(--danger)">${formatCurrency(product.buyPrice)}</td>
          <td style="color:var(--accent)">${formatCurrency(product.sellPrice)}</td>
          <td style="color:var(--success);font-weight:600">+${formatCurrency(product.profit)}</td>
          <td><span style="color:${marginColor};font-weight:700">${product.margin}%</span></td>
          <td>${product.sales}</td>
          <td style="color:var(--success);font-weight:700">${formatCurrency(product.monthlyProfit)}</td>
          <td><span class="badge" style="background:${roiColor}20;color:${roiColor}">${product.roi}%</span></td>
        </tr>
      `;
    }).join('');
    
    // Add total row
    const totalMonthlyProfit = products.reduce((sum, p) => sum + p.monthlyProfit, 0);
    const avgMargin = (products.reduce((sum, p) => sum + p.margin, 0) / products.length).toFixed(0);
    const avgROI = (products.reduce((sum, p) => sum + p.roi, 0) / products.length).toFixed(0);
    
    tbody.innerHTML += `
      <tr style="background:var(--bg-secondary);font-weight:700">
        <td colspan="2">TOTAL / MOYENNE</td>
        <td>-</td>
        <td>-</td>
        <td>-</td>
        <td style="color:var(--warning)">${avgMargin}%</td>
        <td>-</td>
        <td style="color:var(--success);font-size:18px">${formatCurrency(totalMonthlyProfit)}</td>
        <td style="color:var(--accent)">${avgROI}%</td>
      </tr>
    `;
  }
}

// ===== Load Top Profitable Products =====
function loadTopProfitableProducts() {
  const topProducts = [
    {name: 'AMNESIA 10G', margin: 400, monthlyProfit: 1056},
    {name: 'EL JEFE 2G', margin: 257, monthlyProfit: 1080},
    {name: 'DEMBELE 10G', margin: 355, monthlyProfit: 1170},
    {name: 'AMNESIA 5G', margin: 400, monthlyProfit: 840},
    {name: 'FRESH FROZEN 5G', margin: 400, monthlyProfit: 768}
  ];
  
  const container = document.getElementById('topProfitableProducts');
  if (container) {
    container.innerHTML = topProducts.map((product, index) => `
      <div style="margin-bottom:16px;padding:12px;background:var(--bg-secondary);border-radius:8px;display:flex;justify-content:space-between;align-items:center">
        <div style="display:flex;align-items:center;gap:12px">
          <span style="font-size:20px;font-weight:700;color:var(--muted)">#${index + 1}</span>
          <div>
            <div style="font-weight:600">${product.name}</div>
            <div style="font-size:12px;color:var(--muted)">Marge: ${product.margin}%</div>
          </div>
        </div>
        <div style="text-align:right">
          <div style="font-size:18px;font-weight:700;color:var(--success)">${formatCurrency(product.monthlyProfit)}</div>
          <div style="font-size:11px;color:var(--muted)">/mois</div>
        </div>
      </div>
    `).join('');
  }
}

// ===== Profit Calculation =====
function updateProfitCalculation() {
  const product = document.getElementById('calcProduct').value;
  const quantity = parseFloat(document.getElementById('calcQuantity').value) || 0;
  const buyPrice = parseFloat(document.getElementById('calcBuyPrice').value) || 0;
  const sellPrice = parseFloat(document.getElementById('calcSellPrice').value) || 0;
  const salesCount = parseInt(document.getElementById('calcSalesCount').value) || 1;
  
  if (product && quantity && buyPrice && sellPrice) {
    // Calculate costs and profits
    const totalBuyCost = buyPrice * quantity;
    const unitProfit = sellPrice - totalBuyCost;
    const margin = ((unitProfit / sellPrice) * 100).toFixed(1);
    const totalRevenue = sellPrice * salesCount;
    const totalProfit = unitProfit * salesCount;
    
    // Update results
    document.getElementById('resultBuyCost').textContent = formatCurrency(totalBuyCost);
    document.getElementById('resultSellPrice').textContent = formatCurrency(sellPrice);
    document.getElementById('resultUnitProfit').textContent = formatCurrency(unitProfit);
    document.getElementById('resultMargin').textContent = margin + '%';
    document.getElementById('resultTotalRevenue').textContent = formatCurrency(totalRevenue);
    document.getElementById('resultTotalProfit').textContent = formatCurrency(totalProfit);
    
    // Update profit ratio bar
    const costPercentage = (totalBuyCost / sellPrice * 100).toFixed(0);
    const profitPercentage = (unitProfit / sellPrice * 100).toFixed(0);
    document.getElementById('costBar').style.width = costPercentage + '%';
    document.getElementById('profitBar').style.width = profitPercentage + '%';
    document.getElementById('profitRatio').textContent = margin + '% de marge';
    
    // Color code based on margin
    const profitElement = document.getElementById('resultTotalProfit');
    const marginElement = document.getElementById('resultMargin');
    
    if (margin >= 200) {
      profitElement.style.color = 'var(--success)';
      marginElement.style.color = 'var(--success)';
    } else if (margin >= 100) {
      profitElement.style.color = 'var(--warning)';
      marginElement.style.color = 'var(--warning)';
    } else {
      profitElement.style.color = 'var(--danger)';
      marginElement.style.color = 'var(--danger)';
    }
    
    // Show results
    document.getElementById('profitResults').style.display = 'block';
    
    // Auto-fill common prices if product is selected
    if (product && !sellPrice) {
      const defaultPrices = {
        'amnesia': {5: 30, 10: 60, 50: 250, 100: 450},
        'needles': {1: 20, 2: 40, 3: 50, 5: 80, 10: 150},
        'eljefe': {1: 50, 2: 100, 5: 250, 10: 430},
        'skittlez': {5: 40, 10: 70, 50: 290},
        'dembele': {5: 30, 10: 50, 50: 190, 100: 370},
        'lemon': {3.5: 40, 5: 60, 10: 110}
      };
      
      if (defaultPrices[product] && defaultPrices[product][quantity]) {
        document.getElementById('calcSellPrice').value = defaultPrices[product][quantity];
        updateProfitCalculation();
      }
    }
  } else {
    document.getElementById('profitResults').style.display = 'none';
  }
}

// ===== Simulate Price Strategy =====
function simulatePriceStrategy(increase) {
  const increasePercent = parseFloat(increase);
  document.getElementById('priceIncreaseValue').textContent = increasePercent > 0 ? '+' + increasePercent : increasePercent;
  
  // Base values
  const baseRevenue = 8750;
  const baseProfit = 5550;
  const baseMargin = 63.4;
  
  // Calculate impacts
  const revenueImpact = (baseRevenue * increasePercent / 100);
  const profitImpact = revenueImpact; // Assuming costs stay the same
  const newMargin = baseMargin + (increasePercent * 0.8); // Margin increases with price
  
  // Update display
  const revenueElement = document.getElementById('revenueImpact');
  const profitElement = document.getElementById('profitImpact');
  const marginElement = document.getElementById('newMargin');
  
  revenueElement.textContent = (revenueImpact >= 0 ? '+' : '') + formatCurrency(revenueImpact);
  profitElement.textContent = (profitImpact >= 0 ? '+' : '') + formatCurrency(profitImpact);
  marginElement.textContent = newMargin.toFixed(1) + '%';
  
  // Color coding
  if (increasePercent > 0) {
    revenueElement.style.color = 'var(--success)';
    profitElement.style.color = 'var(--success)';
  } else if (increasePercent < 0) {
    revenueElement.style.color = 'var(--danger)';
    profitElement.style.color = 'var(--danger)';
  } else {
    revenueElement.style.color = 'var(--accent)';
    profitElement.style.color = 'var(--accent)';
  }
}

// ===== Load Stock =====
function loadStock() {
  const stockData = [
    {product: 'AMNESIA', variant: '5G', stock: 45, value: 1350, status: 'ok', lastUpdate: new Date()},
    {product: 'NEEDLES KETA', variant: '2G', stock: 30, value: 1200, status: 'ok', lastUpdate: new Date()},
    {product: 'EL JEFE', variant: '1G', stock: 8, value: 400, status: 'low', lastUpdate: new Date()},
    {product: 'SKITTLEZ CAKE', variant: '10G', stock: 0, value: 0, status: 'out', lastUpdate: new Date()},
    {product: 'LEMON X GELATO', variant: '3.5G', stock: 25, value: 1000, status: 'ok', lastUpdate: new Date()}
  ];
  
  // Populate product select
  const productSelect = document.getElementById('stockProduct');
  if (productSelect && productSelect.options.length <= 1) {
    const products = ['AMNESIA', 'NEEDLES KETA', 'CHAMPAGNE', 'EL JEFE', 'SKITTLEZ CAKE', 'PISTACCHIO', 'DEMBELE', 'LEMON X GELATO', 'GEORGIA PIE', 'DOMINO', 'FRESH FROZEN'];
    products.forEach(product => {
      const option = document.createElement('option');
      option.value = product;
      option.textContent = product;
      productSelect.appendChild(option);
    });
    
    // Add event listener for product select
    productSelect.addEventListener('change', (e) => {
      const variantSelect = document.getElementById('stockVariant');
      if (e.target.value) {
        variantSelect.disabled = false;
        variantSelect.innerHTML = '<option value="">S√©lectionner...</option>';
        const variants = ['1G', '2G', '3G', '3.5G', '5G', '10G', '50G', '100G'];
        variants.forEach(variant => {
          const option = document.createElement('option');
          option.value = variant;
          option.textContent = variant;
          variantSelect.appendChild(option);
        });
      } else {
        variantSelect.disabled = true;
      }
    });
  }
  
  const tbody = document.getElementById('stockTable');
  if (tbody) {
    tbody.innerHTML = stockData.map(item => {
      let statusBadge = '';
      if (item.status === 'ok') {
        statusBadge = '<span class="badge success">‚úÖ OK</span>';
      } else if (item.status === 'low') {
        statusBadge = '<span class="badge warning">‚ö†Ô∏è Stock bas</span>';
      } else {
        statusBadge = '<span class="badge danger">‚ùå Rupture</span>';
      }
      
      return `
        <tr>
          <td><strong>${item.product}</strong></td>
          <td>${item.variant}</td>
          <td><strong style="color:var(--accent)">${item.stock}</strong></td>
          <td>${formatCurrency(item.value)}</td>
          <td>${statusBadge}</td>
          <td>${formatDate(item.lastUpdate)}</td>
          <td class="actions">
            <button class="btn-sm btn-success" onclick="quickAddStock('${item.product}', '${item.variant}')">‚ûï Ajouter</button>
            <button class="btn-sm btn-warning" onclick="adjustStock('${item.product}', '${item.variant}')">‚öñÔ∏è Ajuster</button>
          </td>
        </tr>
      `;
    }).join('');
  }
}

// ===== Settings Functions =====
function showSettingsSection(section) {
  // Hide all sections
  document.querySelectorAll('.settings-section').forEach(s => {
    s.style.display = 'none';
    s.classList.remove('active');
  });
  
  // Show selected section
  const selectedSection = document.getElementById(`settings-${section}`);
  if (selectedSection) {
    selectedSection.style.display = 'block';
    selectedSection.classList.add('active');
  }
  
  // Update menu items
  document.querySelectorAll('.settings-menu-item').forEach(item => {
    item.classList.remove('active');
  });
  event.target.classList.add('active');
}

// ===== Product Functions =====
function editProduct(id) {
  showToast(`√âdition du produit #${id}`);
}

function viewProductStock(id) {
  showToast(`Affichage du stock produit #${id}`);
}

function deleteProduct(id) {
  if (confirm('Supprimer ce produit ?')) {
    showToast('Produit supprim√©', 'success');
    loadProducts();
  }
}

function addNewProduct() {
  showToast('Ouverture du formulaire d\'ajout');
}

// ===== Customer Functions =====
function viewCustomer(id) {
  showToast(`Affichage du client #${id}`);
}

function sendMessage(id) {
  showToast(`Envoi d'un message au client #${id}`);
}

function deleteCustomer(id) {
  if (confirm('Supprimer ce client ?')) {
    showToast('Client supprim√©', 'success');
    loadCustomers();
  }
}

function addNewCustomer() {
  showToast('Ouverture du formulaire d\'ajout client');
}

function exportCustomers() {
  showToast('Export des clients en cours...');
}

// ===== Stock Functions =====
function quickAddStock(product, variant) {
  const qty = prompt(`Quantit√© √† ajouter pour ${product} - ${variant}:`, '10');
  if (qty && !isNaN(qty)) {
    showToast(`Ajout de ${qty} unit√©s`, 'success');
    loadStock();
  }
}

function adjustStock(product, variant) {
  const newQty = prompt(`Nouveau stock pour ${product} - ${variant}:`, '0');
  if (newQty && !isNaN(newQty)) {
    showToast('Stock ajust√©', 'success');
    loadStock();
  }
}

// ===== Settings Save Functions =====
function saveSettings() {
  showToast('Param√®tres sauvegard√©s', 'success');
}

function updatePassword() {
  const oldPass = document.getElementById('oldPassword').value;
  const newPass = document.getElementById('newPassword').value;
  const confirmPass = document.getElementById('confirmPassword').value;
  
  if (newPass !== confirmPass) {
    showToast('Les mots de passe ne correspondent pas', 'error');
    return;
  }
  
  if (newPass.length < 8) {
    showToast('Le mot de passe doit contenir au moins 8 caract√®res', 'error');
    return;
  }
  
  showToast('Mot de passe mis √† jour', 'success');
}

function saveNotifications() {
  showToast('Pr√©f√©rences de notifications sauvegard√©es', 'success');
}

function saveDeliverySettings() {
  showToast('Param√®tres de livraison sauvegard√©s', 'success');
}

function savePaymentSettings() {
  showToast('M√©thodes de paiement sauvegard√©es', 'success');
}

function exportDatabaseSQL() {
  showToast('Export SQL en cours...', 'success');
}

function createBackup() {
  showToast('Cr√©ation de la sauvegarde...', 'success');
}

function restoreBackup() {
  if (confirm('Restaurer une sauvegarde √©crasera toutes les donn√©es actuelles. Continuer ?')) {
    showToast('Restauration en cours...', 'warning');
  }
}

function clearAllData() {
  if (confirm('‚ö†Ô∏è ATTENTION : Cette action supprimera TOUTES les donn√©es. √ätes-vous s√ªr ?')) {
    if (confirm('‚ö†Ô∏è DERNI√àRE CONFIRMATION : Toutes les donn√©es seront perdues d√©finitivement !')) {
      localStorage.clear();
      showToast('Toutes les donn√©es ont √©t√© supprim√©es', 'success');
      setTimeout(() => location.reload(), 2000);
    }
  }
}

// ===== Load Stats =====
function loadStats() {
  // Demo data
  document.getElementById('totalCA').textContent = formatCurrency(8750);
  document.getElementById('totalOrders').textContent = '42';
  document.getElementById('avgOrder').textContent = formatCurrency(208);
  document.getElementById('topProduct').textContent = 'AMNESIA';
  document.getElementById('topProductSales').textContent = '15 ventes';
  document.getElementById('stockValue').textContent = formatCurrency(12500);
  document.getElementById('stockItems').textContent = '324 articles';
  document.getElementById('stockAlerts').textContent = '3';
  document.getElementById('stockAlertDetails').innerHTML = '<span style="color:var(--danger)">2 ruptures</span> ‚Ä¢ <span style="color:var(--warning)">1 stock bas</span>';
  
  // Update progress bars
  document.getElementById('progressCA').style.width = '65%';
  document.getElementById('trendCA').innerHTML = '<span>‚Üó</span><span>+12% vs mois dernier</span>';
}

// ===== Initialize Tabs =====
function initTabs() {
  document.querySelectorAll('.tab-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      // Remove active from all tabs
      document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
      
      // Add active to clicked tab
      btn.classList.add('active');
      const tabId = `tab-${btn.dataset.tab}`;
      const tabContent = document.getElementById(tabId);
      if (tabContent) {
        tabContent.classList.add('active');
        
        // Load content for specific tabs
        switch(btn.dataset.tab) {
          case 'orders':
            loadDemoOrders();
            break;
          case 'finances':
            loadFinances();
            break;
          case 'stock':
            loadStock();
            break;
          case 'products':
            loadProducts();
            break;
          case 'customers':
            loadCustomers();
            break;
          case 'analytics':
            // Analytics already has static content
            break;
          case 'settings':
            // Settings already loaded
            break;
        }
      }
    });
  });
}

// ===== Initialize Theme =====
function initTheme() {
  const toggle = document.getElementById('themeToggle');
  if (toggle) {
    toggle.addEventListener('click', () => {
      const body = document.body;
      const currentTheme = body.getAttribute('data-theme');
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      body.setAttribute('data-theme', newTheme);
      toggle.classList.toggle('light', newTheme === 'light');
      localStorage.setItem('theme', newTheme);
    });
    
    // Load saved theme
    const savedTheme = localStorage.getItem('theme') || 'dark';
    document.body.setAttribute('data-theme', savedTheme);
    toggle.classList.toggle('light', savedTheme === 'light');
  }
}

// ===== Load Demo Orders =====
function loadDemoOrders() {
  const orders = [
    {id: 1, date: new Date(), customer: 'Jean Dupont', items: 3, total: 120, status: 'pending', payment: 'Esp√®ces'},
    {id: 2, date: new Date(Date.now() - 86400000), customer: 'Marie Martin', items: 2, total: 85, status: 'delivered', payment: 'CB'},
    {id: 3, date: new Date(Date.now() - 172800000), customer: 'Paul Durand', items: 1, total: 50, status: 'processing', payment: 'Crypto'},
  ];
  
  const tbody = document.getElementById('ordersTable');
  if (tbody) {
    tbody.innerHTML = orders.map(order => `
      <tr>
        <td><strong>#${order.id}</strong></td>
        <td>${formatDate(order.date)}</td>
        <td>${order.customer}</td>
        <td>${order.items} articles</td>
        <td><strong>${formatCurrency(order.total)}</strong></td>
        <td>${getStatusBadge(order.status)}</td>
        <td><span class="badge">${order.payment}</span></td>
        <td class="actions">
          <button class="btn-sm btn-primary" onclick="viewOrder(${order.id})">üëÅÔ∏è</button>
          <button class="btn-sm btn-success" onclick="editOrder(${order.id})">‚úèÔ∏è</button>
          <button class="btn-sm btn-danger" onclick="deleteOrder(${order.id})">üóëÔ∏è</button>
        </td>
      </tr>
    `).join('');
  }
}

// ===== Get Status Badge =====
function getStatusBadge(status) {
  const badges = {
    pending: '<span class="badge warning">‚è≥ En attente</span>',
    processing: '<span class="badge info">üîÑ En traitement</span>',
    delivered: '<span class="badge success">‚úÖ Livr√©</span>',
    cancelled: '<span class="badge danger">‚ùå Annul√©</span>'
  };
  return badges[status] || badges.pending;
}

// ===== Update Activity Feed =====
function updateActivityFeed() {
  const activities = [
    { text: 'Nouvelle commande #123', time: 'Il y a 2 min', icon: 'üì¶' },
    { text: 'Stock AMNESIA mis √† jour', time: 'Il y a 5 min', icon: 'üìä' },
    { text: 'Nouvel avis 5‚≠ê sur EL JEFE', time: 'Il y a 12 min', icon: '‚≠ê' }
  ];
  
  const feed = document.getElementById('activityFeed');
  if (feed) {
    feed.innerHTML = activities.map(activity => `
      <div style="padding:12px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center">
        <div>
          <div style="font-weight:600">${activity.text}</div>
          <div style="font-size:12px;color:var(--muted);margin-top:4px">${activity.time}</div>
        </div>
        <span style="font-size:20px">${activity.icon}</span>
      </div>
    `).join('');
  }
}

// ===== Update Quick Stats =====
function updateQuickStats() {
  document.getElementById('todayRevenue').textContent = formatCurrency(450);
  document.getElementById('weekRevenue').textContent = formatCurrency(2340);
  document.getElementById('monthRevenue').textContent = formatCurrency(8750);
  document.getElementById('activeOrders').textContent = '5';
  document.getElementById('lowStock').textContent = '3';
  document.getElementById('pendingReviews').textContent = '2';
  
  // Update goals progress
  document.getElementById('goalCA').textContent = '65%';
  document.getElementById('goalCABar').style.width = '65%';
  document.getElementById('goalOrders').textContent = '80%';
  document.getElementById('goalOrdersBar').style.width = '80%';
  document.getElementById('goalCustomers').textContent = '45%';
  document.getElementById('goalCustomersBar').style.width = '45%';
  
  // Update top products
  const topProducts = document.getElementById('topProductsChart');
  if (topProducts) {
    topProducts.innerHTML = `
      <div style="padding:20px">
        <div style="margin-bottom:16px">
          <div style="display:flex;justify-content:space-between;margin-bottom:8px">
            <span>1. AMNESIA</span>
            <span style="color:var(--accent)">35 ventes</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" style="width:100%"></div>
          </div>
        </div>
        <div style="margin-bottom:16px">
          <div style="display:flex;justify-content:space-between;margin-bottom:8px">
            <span>2. EL JEFE</span>
            <span style="color:var(--accent)">28 ventes</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" style="width:80%"></div>
          </div>
        </div>
        <div style="margin-bottom:16px">
          <div style="display:flex;justify-content:space-between;margin-bottom:8px">
            <span>3. NEEDLES KETA</span>
            <span style="color:var(--accent)">22 ventes</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" style="width:63%"></div>
          </div>
        </div>
        <div style="margin-bottom:16px">
          <div style="display:flex;justify-content:space-between;margin-bottom:8px">
            <span>4. SKITTLEZ CAKE</span>
            <span style="color:var(--accent)">18 ventes</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" style="width:51%"></div>
          </div>
        </div>
        <div>
          <div style="display:flex;justify-content:space-between;margin-bottom:8px">
            <span>5. LEMON X GELATO</span>
            <span style="color:var(--accent)">15 ventes</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" style="width:43%"></div>
          </div>
        </div>
      </div>
    `;
  }
}

// ===== Utility Functions =====
function closeModal(modalId) {
  const modal = document.getElementById(modalId);
  if (modal) modal.classList.remove('active');
}

function logout() {
  localStorage.removeItem('isLoggedIn');
  location.reload();
}

function viewOrder(id) {
  console.log('View order:', id);
  showToast('Affichage de la commande #' + id);
}

function editOrder(id) {
  console.log('Edit order:', id);
  showToast('√âdition de la commande #' + id);
}

function deleteOrder(id) {
  if (confirm('Supprimer cette commande ?')) {
    console.log('Delete order:', id);
    showToast('Commande supprim√©e', 'success');
  }
}

// ===== Initialize Finance Tab =====
function initFinanceTab() {
  // Set default sales count
  const salesCountField = document.getElementById('calcSalesCount');
  if (salesCountField && !salesCountField.value) {
    salesCountField.value = 10; // Default to 10 sales
  }
  
  // Load finances data
  loadFinances();
}

// ===== Dropdown Menu Functions =====
function showProfile() {
  showToast('Ouverture du profil administrateur');
}

function showSettings() {
  // Activate settings tab
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
  
  const settingsTab = document.querySelector('[data-tab="settings"]');
  const settingsContent = document.getElementById('tab-settings');
  
  if (settingsTab && settingsContent) {
    settingsTab.classList.add('active');
    settingsContent.classList.add('active');
  }
  
  // Close dropdown
  document.querySelectorAll('.dropdown').forEach(d => d.classList.remove('active'));
}

// ===== Export All Data =====
function exportAllData() {
  const data = {
    orders: [],
    products: [],
    customers: [],
    stock: [],
    finances: [],
    exportDate: new Date().toISOString(),
    version: '2.0.0'
  };
  
  // Add sample data
  data.orders = [
    {id: 1, date: new Date(), customer: 'Jean Dupont', total: 120, status: 'delivered'},
    {id: 2, date: new Date(), customer: 'Marie Martin', total: 85, status: 'pending'}
  ];
  
  const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `drogua_export_${Date.now()}.json`;
  a.click();
  
  showToast('Export complet r√©ussi', 'success');
}

// ===== Page Load =====
document.addEventListener('DOMContentLoaded', () => {
  console.log('Page charg√©e');
  
  // Check if already logged in
  if (localStorage.getItem('isLoggedIn') === 'true') {
    document.getElementById('auth').style.display = 'none';
    document.getElementById('dash').style.display = 'block';
    initDashboard();
  } else {
    document.getElementById('auth').style.display = 'block';
    document.getElementById('dash').style.display = 'none';
  }
  
  // Allow Enter key to submit login
  document.getElementById('pass').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
      handleLogin();
    }
  });
  
  // User menu dropdown
  const userMenu = document.getElementById('userMenu');
  if (userMenu) {
    userMenu.addEventListener('click', (e) => {
      e.stopPropagation();
      const dropdown = e.target.closest('.dropdown');
      if (dropdown) dropdown.classList.toggle('active');
    });
  }
  
  // Close dropdowns on outside click
  document.addEventListener('click', () => {
    document.querySelectorAll('.dropdown').forEach(d => d.classList.remove('active'));
  });
});

// ===== Product Price Presets =====
const PRODUCT_PRICES = {
  'amnesia': {
    name: 'AMNESIA',
    buyPrice: 1.2, // ‚Ç¨/g
    variants: {
      3.33: 20,
      5: 30,
      10: 60,
      50: 250,
      100: 450
    }
  },
  'needles': {
    name: 'NEEDLES KETA',
    buyPrice: 4, // ‚Ç¨/g
    variants: {
      1: 20,
      2: 40,
      3: 50,
      5: 80,
      10: 150
    }
  },
  'champagne': {
    name: 'CHAMPAGNE',
    buyPrice: 3.5, // ‚Ç¨/g
    variants: {
      1: 20,
      2: 40,
      3: 50,
      5: 80,
      10: 150
    }
  },
  'eljefe': {
    name: 'EL JEFE',
    buyPrice: 14, // ‚Ç¨/g
    variants: {
      0.5: 30,
      1: 50,
      2: 100,
      5: 250,
      10: 430
    }
  },
  'skittlez': {
    name: 'SKITTLEZ CAKE',
    buyPrice: 2, // ‚Ç¨/g
    variants: {
      2.5: 20,
      5: 40,
      10: 70,
      50: 290
    }
  },
  'pistacchio': {
    name: 'PISTACCHIO',
    buyPrice: 1.8, // ‚Ç¨/g
    variants: {
      3: 20,
      5: 50,
      10: 90,
      50: 250
    }
  },
  'dembele': {
    name: 'DEMBELE',
    buyPrice: 1.1, // ‚Ç¨/g
    variants: {
      3.5: 20,
      5: 30,
      10: 50,
      50: 190,
      100: 370
    }
  },
  'lemon': {
    name: 'LEMON X GELATO',
    buyPrice: 3.4, // ‚Ç¨/g
    variants: {
      1.66: 20,
      3.5: 40,
      5: 60,
      10: 110
    }
  },
  'georgia': {
    name: 'GEORGIA PIE',
    buyPrice: 3.4, // ‚Ç¨/g
    variants: {
      1.66: 20,
      3.5: 40,
      5: 60,
      10: 110
    }
  },
  'domino': {
    name: 'DOMINO',
    buyPrice: 2.5, // ‚Ç¨/unit√©
    variants: {
      3: 20,
      10: 60,
      50: 150
    }
  },
  'fresh': {
    name: 'FRESH FROZEN',
    buyPrice: 3.2, // ‚Ç¨/g
    variants: {
      1.1: 20,
      2.3: 40,
      3.5: 50,
      5: 80,
      10: 160
    }
  }
};

// ===== Enhanced Profit Calculation =====
document.getElementById('calcProduct')?.addEventListener('change', function(e) {
  const product = e.target.value;
  if (product && PRODUCT_PRICES[product]) {
    // Auto-fill buy price
    const buyPriceField = document.getElementById('calcBuyPrice');
    if (!buyPriceField.value) {
      buyPriceField.value = PRODUCT_PRICES[product].buyPrice;
    }
    
    // Update quantity options based on product
    const quantitySelect = document.getElementById('calcQuantity');
    const variants = Object.keys(PRODUCT_PRICES[product].variants);
    
    quantitySelect.innerHTML = '<option value="">S√©lectionner</option>';
    variants.forEach(variant => {
      const option = document.createElement('option');
      option.value = variant;
      option.textContent = variant + (product === 'domino' ? ' unit√©s' : 'G');
      quantitySelect.appendChild(option);
    });
  }
});

document.getElementById('calcQuantity')?.addEventListener('change', function(e) {
  const product = document.getElementById('calcProduct').value;
  const quantity = parseFloat(e.target.value);
  
  if (product && quantity && PRODUCT_PRICES[product]) {
    // Auto-fill sell price based on product and quantity
    const sellPriceField = document.getElementById('calcSellPrice');
    if (PRODUCT_PRICES[product].variants[quantity]) {
      sellPriceField.value = PRODUCT_PRICES[product].variants[quantity];
      updateProfitCalculation();
    }
  }
});

// ===== Initialize Finance Tab =====
function initFinanceTab() {
  // Set default sales count
  const salesCountField = document.getElementById('calcSalesCount');
  if (salesCountField && !salesCountField.value) {
    salesCountField.value = 10; // Default to 10 sales
  }
  
  // Load finances data
  loadFinances();
}

// Add to the tab click handler
document.querySelectorAll('.tab-btn').forEach(btn => {
  if (btn.dataset.tab === 'finances') {
    btn.addEventListener('click', initFinanceTab);
  }
});

// ===== Product Price Presets =====
function showProfile() {
  showToast('Ouverture du profil administrateur');
}

function showSettings() {
  // Activate settings tab
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
  
  const settingsTab = document.querySelector('[data-tab="settings"]');
  const settingsContent = document.getElementById('tab-settings');
  
  if (settingsTab && settingsContent) {
    settingsTab.classList.add('active');
    settingsContent.classList.add('active');
  }
  
  // Close dropdown
  document.querySelectorAll('.dropdown').forEach(d => d.classList.remove('active'));
}

// ===== Export All Data =====
function exportAllData() {
  const data = {
    orders: [],
    products: [],
    customers: [],
    stock: [],
    finances: [],
    exportDate: new Date().toISOString(),
    version: '2.0.0'
  };
  
  // Add sample data
  data.orders = [
    {id: 1, date: new Date(), customer: 'Jean Dupont', total: 120, status: 'delivered'},
    {id: 2, date: new Date(), customer: 'Marie Martin', total: 85, status: 'pending'}
  ];
  
  const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `drogua_export_${Date.now()}.json`;
  a.click();
  
  showToast('Export complet r√©ussi', 'success');
}

// ===== Stock Movement =====
document.getElementById('addStockMovement')?.addEventListener('click', () => {
  const product = document.getElementById('stockProduct').value;
  const variant = document.getElementById('stockVariant').value;
  const type = document.getElementById('stockType').value;
  const qty = document.getElementById('stockQty').value;
  const price = document.getElementById('stockPrice').value;
  const reason = document.getElementById('stockReason').value;
  
  if (!product || !variant || !qty) {
    showToast('Veuillez remplir tous les champs obligatoires', 'error');
    return;
  }
  
  const typeText = type === 'in' ? 'Entr√©e' : type === 'out' ? 'Sortie' : 'Ajustement';
  showToast(`${typeText} de ${qty} ${product} ${variant} enregistr√©e`, 'success');
  
  // Reset form
  document.getElementById('stockProduct').value = '';
  document.getElementById('stockVariant').value = '';
  document.getElementById('stockVariant').disabled = true;
  document.getElementById('stockQty').value = '1';
  document.getElementById('stockPrice').value = '';
  document.getElementById('stockReason').value = '';
  
  // Reload stock table
  loadStock();
});

console.log('Script charg√© - Mot de passe attendu: gangstaforlife12');
</script>

</body>
</html>
